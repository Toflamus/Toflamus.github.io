<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://toflamus.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://toflamus.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-04-28T21:26:31+00:00</updated><id>https://toflamus.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Can high voltage battery shocks a man?How? 一块高压蓄电池能否以及如何让人中电</title><link href="https://toflamus.github.io/blog/2024/battery-and-GND/" rel="alternate" type="text/html" title="Can high voltage battery shocks a man?How? 一块高压蓄电池能否以及如何让人中电"/><published>2024-04-28T00:00:00+00:00</published><updated>2024-04-28T00:00:00+00:00</updated><id>https://toflamus.github.io/blog/2024/battery-and-GND</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/battery-and-GND/"><![CDATA[<p>今天在看L.Plett的BMS书，Vol2 电池安全防护这一节（1.7）。突然让我重新回忆起一个困扰我许久的问题。</p> <blockquote> <p>假设一个人手握一个12V的电池的正负极的任意一级光脚站在地上。它感受到的电压是多少？握在正极和负极的感受到的电压一样吗？btw 这里我主要是想讨论中电问题，也就是说一个人是否会因为触摸高电压电池而中电。</p> </blockquote> <p>我之前所想的是：</p> <ul> <li>一块高压蓄电池的电压的主要部分是由物理化学规律决定的，那么这个电压就是一个相对电压，我无法得到某个电极的绝对电压。因此也无法衡量一个电极和大地的电势差，也无法根据36V安全定律来判断是否会安全。</li> <li>并且因为人和电池没有形成回路，那么如何放电。</li> </ul> <p>然而在朋友圈进行询问之后不久便得到了一个答案，醍醐灌顶：</p> <blockquote> <p>你把它想象成电容就好理解了,12V只是两块板之间的电压差，而你感受的电压跟你手中那块极板到地面的距离，还有各种其他因素决定，不是固定的。<br/> ——来自Magdalen的好兄弟</p> </blockquote> <p>电容解释非常中肯，在真实的电池体系中也会出现Double layer capacitance。在电极材料表面就会充电。电池的充放电的回路要求是建立在基尔霍夫定律上的。就是说电荷守恒的条件，但是这个条件在带电体的形况下不满足。</p> <p>这不禁让我回想起初中时的测量物体是否带电的实验。摩擦毛皮和玻璃棒让后放到测电器的金属球上面，测电器的金属箔片会打开一个小张角，证明玻璃棒带点。</p>]]></content><author><name></name></author><category term="battery-study"/><category term="batteries"/><category term="insights"/><category term="shortposts"/><category term="chinese"/><summary type="html"><![CDATA[A interesting problem regarding a man holding battery electrode and standing on the ground.一个关于高压蓄电池如何让人中电的有趣问题。]]></summary></entry><entry><title type="html">Hysteresis voltage modeling</title><link href="https://toflamus.github.io/blog/2024/Hysteresis-voltage/" rel="alternate" type="text/html" title="Hysteresis voltage modeling"/><published>2024-04-27T14:25:00+00:00</published><updated>2024-04-27T14:25:00+00:00</updated><id>https://toflamus.github.io/blog/2024/Hysteresis-voltage</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/Hysteresis-voltage/"><![CDATA[<h2 id="hysteresis-voltage">Hysteresis voltage</h2> <p>Definition: OCV-SOC curves for charging and discharging Li-ion batteries do not overlap. The difference between the curves is defined as <em>Hysteresis voltage</em>.</p> <p>The modeling can be physics-based or phenomenon-based.</p> <p>I find the modeling of hysteresis is a deep field because the hysteresis phenomenon can happen in various disciplines. There is even a book about hysteresis modeling<d-cite key="hysteresismodelingmath"></d-cite>. There are plenty of different models to model a hysteresis, such as Prandtl-Ishlinskii hysteresis model<d-cite key="4739202"></d-cite>(This is a topic in control engineering). However, they are not covered in this blog post. I just put them here for further reference. The main framework is still from L. Plett’s book.<d-cite key="BMS_vol1"></d-cite></p> <h2 id="main-loop-and-minor-loop">Main loop and minor loop</h2> <p>This part is mainly from the Guillaume Larrat’s thesis. <d-cite key="Lihysteresismodeling"></d-cite></p> <p>The charging and discharging OCV curves that were displayed in the figure below allows to create a voltage hysteresis loop for a SOC varying from 0% to 100% which includes the whole range of possible values for the SOC.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/OCV_curve-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/OCV_curve-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/OCV_curve-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/OCV_curve.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>It is composed of the two <strong>major</strong> OCV curves: a charge from 0% to 100% SOC and a full discharge from 100% to 0%. The corresponding voltage hysteresis loop is then called a major loop. However, if the cell is partially charged or discharged from a state different than 0% or 100%, the OCV will not follow the two curves displayed earlier. If a cell is at a 60% SOC and is then discharged to 40% and then charged back to 60%, this will create a minor loop as shown in Figure below:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/major_minor_loop-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/major_minor_loop-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/major_minor_loop-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/major_minor_loop.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Assupmtion: The loop of a real-time charge/discharge process only locates insides the major loop. Apparently, the changing rate in a minor loop is different from the major loop.</p> <h2 id="hysteresis-modeling">Hysteresis modeling</h2> <p>Let’s just build a simple model:<br/> Assumptions:</p> <ul> <li>Linear: The changing rate of hysteresis voltage only depends the difference between maxium OCV and current OCV.</li> <li>Past path invariant: The hyseresis does not depend on how to get to the state but just and past state themselves. Actually, this is not true.</li> </ul> <p>\(h(z(t)) = OCV_{charge}(z(t))-OCV_{discharge}(z(t))\) \(\frac{dh(z,t)}{dz} = \gamma sgn(\dot z)(M(z,\dot z)- h(z,t))\)</p> <p>$\gamma$ is just a coefficient for linear approximation.<br/> $M(z,\dot z)$: A function that gives the maximum polarization due to the hysteresis as a function of SOC and rate of charge.<br/> $M(z,\dot z)- h(z,t)$: Indicates that the rate of change of the hysteresis voltage is proportional to the distance of the current hysteresis value from the main hysteresis loop. In other words, the driving force decides the rate of change.<br/> $z(t)$ defines the changing direction of the hysteresis. For charging process, $\dot z &gt; 0$, which means hysteresis tends to be larger, this means the $$OCV_{charge}(z(t))$ tends to be closer to the maximum OCV.</p> <p>Because our previous equivalent circuit model depends on the time, we use the chain rule to make the differencial equation a function of time.</p> \[\frac{dh(z,t)}{dz} \frac{dz}{dt} = \gamma sgn(\dot z)(M(z,\dot z)- h(z,t)) \frac{dz}{dt}\] <p>\(\frac{dz}{dt} = -\eta(t)i(t)/Q\) $\dot z sgn(\dot z) = |z|$</p> \[\frac{dh(z,t)}{dz} \frac{dz}{dt} = \gamma (M(z,\dot z)- h(z,t)) *|\frac{\eta(t)i(t)}{Q}|\] <p>To make life easier <strong>assume $I(t)$ &amp; $M(z,\dot z)$ are constant during sampling period</strong>. So if one want to get the fully profile, multiple linear approximation can be made to tackle this problem.</p> <p>Solve the ODE and make it discrete, and do some rearrangements:</p> \[h[s+1] = exp(-|\frac{\eta[s]I\Delta t\gamma}{Q}|)h[s] + M(z,\dot z)(1-exp(-|\frac{\eta[s]I\Delta t\gamma}{Q}|))\] <p>Note: $M(z,\dot z) $ varies with current orientation, the simplest way to make it a const is by $M(z,\dot z) = -M sgn(i(t))$</p> <p>Now the equation becomes:</p> \[h[s+1] = exp(-|\frac{\eta[s]I\Delta t\gamma}{Q}|)h[s] - Msgn(i(t))(1-exp(-|\frac{\eta[s]I\Delta t\gamma}{Q}|))\] <table> <tbody> <tr> <td>$A_H[s] = exp(-</td> <td>\frac{\eta[s]I\Delta t\gamma}{Q}</td> <td>)$</td> </tr> </tbody> </table> <p>\(h[s+1] = A_H h[s] - Msgn(i(t))(1-A_H)\)</p> <h2 id="enhanced-self-correcting-esc-model">Enhanced self-correcting (ESC) model</h2> <p><em>Enhanced</em> means the model also includes hysteresis effects.<br/> <em>Self-correcting</em> means the model converges to the $OCV+hysteresis$ when $i = 0$</p> <p>From the discussion on equivalant circuit models, now with new information with hysteresis effects. The OCV with half cell equivalent circuit can be viewed as follows:</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/circuit1-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/circuit1-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/circuit1-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/circuit1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> half-cell with OCV and hysteresis </div> <p>When the time scale difference bewteen Warburg impedance and other circuit elements are so large, that the Warburg impedance get out on to the main branch.</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/circuit2-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/circuit2-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/circuit2-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/circuit2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> approximation of half-cell with OCV and hysteresis. </div> <p>As we have discussed in another blog the linear part of Warburg impedance can be approximated by a series of parallel resistor-and-capacitor pairs.</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/circuit3-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/circuit3-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/circuit3-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/circuit3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Let’s denote the charge transfer resistance and double layer capacity as $R_{0}$ and $C_{0}$</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/circuit4-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/circuit4-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/circuit4-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/circuit4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="single-resistor-and-capacitor-pair">Single resistor-and-capacitor pair</h3> <p>Let’s use the current to analyze a resistor-and-capacitor pair.</p> <p>For a single pair, use the voltage change of a single resistor-and-capacitor pair as a birdge:</p> <p>\(u_k = \frac{Q_k}{C_k} = \frac{1}{C_k}\int_0^t I-i_k dt\) \(u_k = R_k i_k\)</p> <p>where $i_k$ is the current goes through $R_k$ and I is main branch current.</p> <p>After take a derivative and rearrangement:</p> \[i_k(t) + \frac{i(t)}{C_kR_k} = \frac{I(t)}{C_kR_k}\] <p>Solve the ODE using Cauchy’s method.</p> \[i_k(t) = Ae^{-\frac{t}{C_kR_k}} + i_c(t)\] <p>When in reality, the I(t) can be AC current such as in the case of (EIS). So it can be extended to a fourier series. This means the solution of the ODE is also a fourier series, denoted $i_c(t) = I’(t)$.</p> <p>Now let’s think about the discret form.</p> <p>\(i_k[s] = Ae^{-\frac{s\Delta t}{C_kR_k}} + i_c[s]\) \(i_k[s+1] = Ae^{-\frac{(s+1)\Delta t}{C_kR_k}} + i_c[s+1]\)</p> <p>Then:</p> <p>\(i_k[s+1] = F_k * i_k[s] + i_c[s+1] - F_k i_c[s]\) \(F_k = e^{-\frac{\Delta t}{C_kR_k}}\)</p> <p>To make life easier <strong>assume I(t) is a constant during sample period</strong>. So if one want to get the fully profile, multiple linear approximation can be made to tackle this problem.</p> \[i_c[s] = i_c[s+1] = I\] <p>The original solution becomes:<br/> \(i_k[s+1] = F_k * i_k[s] + (1- F_k)I\)</p> <p>Convert this equation to a matrix form:</p> <p>\(\vec i_r[s+1] = \mathbb A_{RC} * \vec i_r[s] + b_{RC} I\) \(\mathbb A_{RC} = diag(F_k)\) \([\vec b_{RC}]_i = 1-F_i\)</p> <h3 id="esc-model-and-its-state-equation">ESC model and its <em>state equation</em></h3> <p>Combine everything above together, we get the <em>state equation</em> of ESC model [ \begin{bmatrix} z[s+1]<br/> \vec i_r[s+1]<br/> h[s+1]<br/> \end{bmatrix} = \begin{bmatrix} 1 &amp; 0 &amp; 0<br/> 0 &amp; \mathbb A_{RC} &amp; 0 <br/> 0 &amp; 0 &amp; A_H<br/> \end{bmatrix} \begin{bmatrix} z[s]<br/> \vec i_r[s]<br/> h[s]<br/> \end{bmatrix} + \begin{bmatrix} -\frac{\eta [s] \Delta t}{Q} &amp; 0<br/> \vec b_{RC} &amp; 0<br/> 0 &amp; A_H-1 \end{bmatrix} \begin{bmatrix} I &amp; sgn(I)<br/> \end{bmatrix} ]</p> <h2 id="afterwords">Afterwords</h2> <h3 id="soc-method-to-analysis-the-circuit">SOC method to analysis the circuit</h3> <p>When considering the voltage of each resistor-and-capacitor pair,the ODE for a single resistor-and-capacitor pair is:</p> \[\dot u_i = -\frac{1}{R_i C_i} u_i + \frac{1}{C_i} I\] <p>The ODEs for resistor-and-capacitor pairs can be expressed as:</p> <p>\begin{equation} \begin{bmatrix} \dot u_0<br/> \dot u_1<br/> \vdots<br/> \dot u_n<br/> \end{bmatrix} = \begin{bmatrix} -\frac{1}{C_0R_0} &amp; 0 &amp; \cdots &amp; 0 <br/> 0 &amp; -\frac{1}{C_1R_1} &amp; \cdots &amp; 0 <br/> \vdots &amp; 0 &amp; \cdots &amp; 0 <br/> 0 &amp; \cdots &amp; 0 &amp; -\frac{1}{C_nR_n}<br/> \end{bmatrix} \begin{bmatrix} u_0<br/> u_1<br/> \vdots<br/> u_n<br/> \end{bmatrix} + \begin{bmatrix} \frac{1}{C_0}<br/> \frac{1}{C_1}<br/> \vdots<br/> \frac{1}{C_n}<br/> \end{bmatrix} I \end{equation} This is the method with voltage to describe the SOC but however I need to use current instead of voltage to analyze the circuit here.</p> <p>I did not heard about this topic too much before when I concentrated at ElectroChemistry. The hysteresis effect is important for Battery Management Systems.</p>]]></content><author><name></name></author><category term="battery-study"/><category term="batteries"/><category term="longposts"/><category term="lithium-ion"/><summary type="html"><![CDATA[Simple introduce hysteresis voltage and its phenomenological modeling]]></summary></entry><entry><title type="html">Warburg impedance</title><link href="https://toflamus.github.io/blog/2024/Warburg-impedence/" rel="alternate" type="text/html" title="Warburg impedance"/><published>2024-04-26T14:25:00+00:00</published><updated>2024-04-26T14:25:00+00:00</updated><id>https://toflamus.github.io/blog/2024/Warburg-impedence</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/Warburg-impedence/"><![CDATA[<p>The most important thing is that the <em>Warburg impedance</em> models the diffusion in electrode.</p>]]></content><author><name></name></author><category term="battery-study"/><category term="batteries"/><category term="lithium-ion"/><summary type="html"><![CDATA[My first blog]]></summary></entry><entry><title type="html">Build an equivalent circuit of batteries from scratch</title><link href="https://toflamus.github.io/blog/2024/equivalent-circuit-of-batteries/" rel="alternate" type="text/html" title="Build an equivalent circuit of batteries from scratch"/><published>2024-04-26T14:25:00+00:00</published><updated>2024-04-26T14:25:00+00:00</updated><id>https://toflamus.github.io/blog/2024/equivalent-circuit-of-batteries</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/equivalent-circuit-of-batteries/"><![CDATA[<p>This blog is a summary of the problems and concerns one may encounter when consider the battery system. Detailed but not essential formulas are not included. This blog is just a general description.</p> <h2 id="open-circuit-voltageocv-and-state-of-chargesoc-dependence-">Open circuit voltage(OCV) and State of Charge(SOC) dependence <d-cite key="BMS_vol1"></d-cite></h2> <p>The first thing one thinks to build a equivalent circuit is to ADD a <em>voltage source</em> to the circuit. From high school physics, the <em>open circuit voltage</em> is supposed to be the voltage at infinite large load, which means the current density is approximately zero. I previously thinks that the OCV may related to current density, diffusion, kinetics. However, I misunderstood the concept of OCV it is not working. Ideally there is no current, consequently no diffusion and kinetics problems. It should be more stable then I had thought.</p> <p>Nonetheless, it is by no means stationary. From Nernst equation:</p> <p>\(\Delta G = -zFE\) \(E = E^\circ - \frac{RT}{zF}ln(Q_r)\)</p> <p>with the ongoing of reaction the activity is also changed. OK, one may argue that in a <s> rockin' roll </s> the <em>rocking chair battery(RCB)</em> the solvent concentration may not change, just like their famous relative of RCB: <em>Lithium-ion batteries(LIBs)</em>. However, I still thinks SEI formation, surface reshaping, and other side effects may drive the OCV away when using the battery. So here we introduce an important concept called <em>State of Charge(SOC)</em>. This should actually mean the charge status, like SOC = 100% means fully charged. Just like the worrying battery percentage thing in your cellphone. OK, I have to admit this really confused me for several days when I first get to know the concept, because nobody told me the UNIT of SOC(unit of 1). I find people directly use the voltage in a capacitor to be the SOC and this works because ideal capacitors have a linear relationship between voltage and remaining charges.</p> <p>So now we have a circuit with a SOV dependent OCV.</p> <p>By the way, one may come up with the question: <strong>How to test the SOC and OCV relationships?</strong>. Naturally, we may think of a simple method that we charge/discharge the battery to different SOC and wait it to reach equilibrium. This technique is called <em>Galvanostatic internmittent titration test(GITT)</em>. The method involves a small charge/discharge and then a long rest period to allow the cell to equilibrate. Then the voltages at the end of the periods are taken as the OCV. <d-cite key="C26_2"></d-cite></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-26-equivalent-circuit-of-batteries/GITT-480.webp 480w,/assets/img/2024-04-26-equivalent-circuit-of-batteries/GITT-800.webp 800w,/assets/img/2024-04-26-equivalent-circuit-of-batteries/GITT-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-26-equivalent-circuit-of-batteries/GITT.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Here is an typical graphic example of GITT<d-cite key="LIBOCVmodel"></d-cite> </div> <p>Now we can model the SOC(denoted by $z(t)$) with continuous and discrete form by differential and difference equations. Assuming that discharge current is positive.</p> <ul> <li>Continuous form: <ul> <li>$\dot z(t) = -\eta(t)i(t)/Q$</li> <li>$z(t) =z(0) -\frac{1}{Q} \int_0^t \eta(\tau)i(\tau)$</li> </ul> </li> <li>Discrete form: <ul> <li>$z[k+1] = z[k] - \frac{\Delta t}{Q}\eta[k]i[k]$</li> </ul> </li> </ul> <p>Some other concepts and their definitions:</p> <ul> <li><em>total charge capacity(total capacity) $Q$</em>: total charge removed from SOC = 100% to SOC = 0%</li> <li><em>discharge capacity</em>: total charge removed from SOC = 100% to some cut off voltage where SOC &gt; 0%.</li> <li><em>depth of discharge(DOD)</em>: $DOD = 1 - SOC$</li> </ul> <p>OK now I am gonna say that what has been built above is straight forward but a lot too simple.There are a lot of things to be taken into account. <em>Randles circuit</em>, <em>Warburg impedence</em></p> <p>##</p> <hr/> <h2 id="small-talks">Small talks</h2> <blockquote> <p>At winter, the electric car can be driven for less distance not only because the inner resitance of bateries become larger, but also because there is 7% larger air resistance at 5 C compared with 25 C. —My kindly lecturer of C26</p> </blockquote>]]></content><author><name></name></author><category term="battery-study"/><category term="batteries"/><category term="longposts"/><summary type="html"><![CDATA[First blog!]]></summary></entry></feed>