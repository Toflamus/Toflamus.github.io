<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://toflamus.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://toflamus.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-06-14T21:20:25+00:00</updated><id>https://toflamus.github.io/feed.xml</id><title type="html">blank</title><subtitle>A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html"></title><link href="https://toflamus.github.io/blog/2024/2024-04-29-Battery-Managment-Systems/" rel="alternate" type="text/html" title=""/><published>2024-06-14T21:20:25+00:00</published><updated>2024-06-14T21:20:25+00:00</updated><id>https://toflamus.github.io/blog/2024/2024-04-29-Battery-Managment-Systems</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/2024-04-29-Battery-Managment-Systems/"><![CDATA[<h2 id="an-introduction-to-bms">An introduction to BMS</h2> <p>The scale of the book is mainly on how to manage battery system, involves the hardware and software parts. The software part is stressed by different algorithms to model the battery packs.</p> <blockquote> <p>Definition of <em>Battery management(monitoring) systems(BMS)</em>: A permanently installed system(embeded) for measuring, storing and reporting battery parameters.<br/> –IEEE Standard 1491.</p> </blockquote> <p>Purposes:</p> <ol> <li>To protect the safety of operator and system components.</li> <li>To prolong the life of the batteries.</li> <li>To keep the battery functioning.</li> </ol> <p>Marginal effect: When do we need BMS？</p> <p>Cost of failure(Expectation) and related cost higher than then cost of BMS.</p> <p>Important in such cases:</p> <ul> <li><em>Hybrid-electric vehicles(HEVs)</em>: Never charge its batteries by a blug. The BMS combines the gasoline engine and make full use of the energy.</li> <li><em>Plug-in HEVs(PHEVs)</em>: It can opertate in electric only mode and prosess a larger battery pack. <ul> <li>Charge-depletion mode: Just use electricity to operate.</li> <li>Charge-sustaining mode: When the battery is nearly empty, it starts to work like HEVs.</li> </ul> </li> <li><em>Extend-range electric vehicles(REVs)</em>: Small gasoline engine and large battery pack. Can operate just like EVs. When the battery runs out of capacity, the gasoline engine provides <em>extended range</em>.</li> <li> <p><em>EVs</em>: Battery-electric vehicles.</p> </li> <li>Grid storage powers, telecoms off-grid power.</li> </ul> <h2 id="battery-pack-topology">Battery-pack topology</h2> <p>Topology is a branch of mathematics that deals with the properties of space that are preserved under continuous deformations, such as stretching, crumpling, and bending, but not tearing or gluing.</p> <p>However, here the word topology refers to how to construct a battery pack. Taking the EVs as an example, a EV generally needs high voltage and large current density.</p> <p>High voltage can be achieved by placing the batteries in series, a <em>series-cell-module(SCM)</em>. While large current density can be achieved by placing them in parallel, a <em>parallel-cell-module(PCM)</em>. However, they all have there defects like large inner resistances which may result in low current and low voltage, respectively.</p> <p>Consequently, there is a <strong>trade-off between series or parallel packing</strong>.</p> <p>However, in engineering practice, we usually build a complex system in modules. We first optimize the topology in a single module and then optimize the topology in modules combinations, so on and so forth. This methodology reduces NRE costs.</p> <p>For example, a classic <em>3P6S</em> module has 18 cells, 3 in parallel and 6 in series. The power and energy are then boteh approximately 18 times that of a single cell.</p> <h2 id="bms-design-requirements">BMS design requirements</h2> <ul> <li>Sensing and high-voltage control: $u,i,T$ monitoring.</li> <li>Protection: against overcharge, overdischarge, overcurrent, short circuits, extreme temperatures.</li> <li>Interface: report the status</li> <li>Performance management: SOC management…</li> <li>Diagnostics: (State of health)SOH, (State of life)SOL …</li> </ul> <h3 id="requirement1-battery-pack-sensing">Requirement1: Battery-pack sensing</h3> <h4 id="voltage">Voltage</h4> <p>Intergrated circuit are ofter used, such as LTC6803<br/> Basic structure: <em>Master-slave system</em></p> <p>When many cells are connected in series <em>high voltage isolation</em> is required but challenging.</p> <h4 id="temperature">Temperature</h4> <p>Battery-pack sensinig: <strong>Temperature</strong>: A model is needed to monitor the temperature inside the battery from external temperature.</p> <p><em>Thermocouple</em>: A thermocouple uses 2 different metals to contact and a tiny voltage generate from from the contact. The voltage can be amplified and measured. However, the measurement requires the a relative sample metal at a known temperature. In other words, it needs a reference state. This method is good for lab but not for production BMS designs.</p> <p><em>Themistor</em>: Resistor-temperature relationship.</p> <p><em>Resistance thermometers(resistance temperature detectorsRTD)</em>: Using resistance/temperature relationship of metals, generally pure materials(Cu, Ni, Pt), to detect temperature. Accurate, fragile. Mostly used in lab.</p> <p>A circuit is used to monitor the resistances of thermistor. Then you can look up to the table for the thermistor-temperature relationship.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/circuit-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/circuit-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/circuit-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/circuit.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h4 id="current">Current</h4> <p><em>Current-shunt</em>: Use a low-value($0.1m\Omega$), high-precision resistor. the $i = v_{shunt}/R_{shunt}$. The signal needs an amplifier to be detectable.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/currentshunt-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/currentshunt-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/currentshunt-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/currentshunt.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> The figure is from L.Plett's book.&lt;d-cite, key='BMS_vol2'&gt;&lt;\d-cite&gt; </div> <ul> <li>Pros: <ul> <li>No zero offset<d-footnote>This may refers to the semiconductor diode which has a threshold voltage to allow current to past through it like short circuit. </d-footnote> compared with hall-effect sensors, regradless of temperature(if the resistor do not vary with temperature).</li> </ul> </li> <li>Cons: <ul> <li>It needs an isolated power supply to support amplifiers.</li> <li>Generate slight amount of hear.</li> </ul> </li> </ul> <p><em>Hall-effect sensors</em>: Detect the magnetic field associated with a current flowing.<br/> A good <a href="https://www.allegromicro.com/en/insights-and-innovations/technical-documents/hall-effect-sensor-ic-publications/hall-effect-ic-applications-guide">web</a> about Hall-effect sensors.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/hall-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/hall-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/hall-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/hall.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> The figure is from L.Plett's book.&lt;d-cite, key='BMS_vol2'&gt;&lt;\d-cite&gt; </div> <ul> <li>Pros: <ul> <li>No isolated power supply.</li> </ul> </li> <li>Cons: <ul> <li>Zero-offset that is hard to calibrate.</li> <li>The zero offset is time and temperature dependent.</li> </ul> </li> <li>Protection: against overcharge, overdischarge, overcurrent, short circuits, extreme temperatures.</li> <li>Interface: report the status</li> <li>Performance management: SOC management…</li> <li>Diagnostics: (State of health)SOH, (State of life)SOL …</li> </ul> <h4 id="high-voltage-contactor-control">High-voltage contactor control</h4> <p>The thing is that most of battery loads are often capacitive, before it can function, a charging process will be started first. If you just use a pure contactor at the starting point the contactor may get fused.</p> <p>So a pre-contrator with a resistor is needed. Just to control the charging process not to be too fast with extreme large current.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/precontactor-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/precontactor-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/precontactor-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/precontactor.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> (a)-(e) demonstrate the process to start charging a device. &lt;d-cite, key='BMS_vol2'&gt;&lt;\d-cite&gt; </div> <h4 id="isolation-sensing">Isolation sensing</h4> <p>Just take a the lead-acid battery in an car as an example. The voltage of the battery is 12V and it is directly installed on the chassis. Though the battery has a package and a totally invisable circuit away from people. However, no one can make sure when there is an accident, the chassis do not connect to one of the electrodes of the battery.</p> <p>In a large battery pack, the DC bus voltage can be in the range of <strong>300~800V</strong>. Consequently, there is a requirement to detect it is shunt or not with chassis. A safety current limit is <strong>0.2mV</strong>.</p> <p>A circuit is required to estimates the isolation resistance on each side of the pack.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/isolationdetect-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/isolationdetect-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/isolationdetect-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/isolationdetect.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Isolation detect circuit &lt;d-cite, key='C26_2'&gt;&lt;\d-cite&gt; </div> <h3 id="requirement4-energy-and-power-estimation">Requirement4: Energy and power estimation</h3> <p>There are only 3 parameters that we know the temperature current and voltage of battery $i$ in the $k^{th}$ time step,$v_k^{(i)}, i_k^{(i)}, T_k^{(i)}$</p> <p>However we need SOC($z_k^{i}$), SOV, remaining capacity$Q_k^{i}$ and inner reisistance$R_k^{i}$ to get energy and power abailable in the next period of time.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/EandPestimationwf-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/EandPestimationwf-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/EandPestimationwf-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/EandPestimationwf.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> Energy and power estimation workflow &lt;d-cite, key='BMS_vol2'&gt;&lt;\d-cite&gt; </div> <h4 id="soc-estimation">SOC estimation</h4> <p>I will do this part in the future</p> <h4 id="energy-estimation">Energy estimation</h4> <p>I will do this part in the future</p> <h4 id="power-estimation">Power estimation</h4> <p>I will do this part in the future</p> <h2 id="afternotes">Afternotes</h2> <p><em>Non-Recurring Engineering(NRE)</em>: Non-Recurring Engineering is the cost of creating a new product and is usually fully paid before any product gets manufactured. This is in contrast with production cost, which is an ongoing cost and is generally based on the quantities produced. For example, in the camera lens industry, the NRE would be the cost of developing the lens designs and tools which will make the lens smooth; the production cost would be the cost to manufacture each camera lens.</p> <p><em>Contactor</em> A contactor is an electrically controlled switch used for switching an electrical power circuit. A contactor is typically controlled by a circuit which has a much lower power level than the switched circuit, such as a 24-volt coil electromagnet controlling a 230-volt motor switch.</p> <p><em>Amplifier(amp)</em>:An amplifier, electronic amplifier or (informally) amp is an electronic device that can increase the magnitude of a signal (a time-varying voltage or current). It is a two-port electronic circuit that uses electric power from a power supply to increase the amplitude (magnitude of the voltage or current) of a signal applied to its input terminals, producing a proportionally greater amplitude signal at its output.<a href="https://en.wikipedia.org/wiki/Amplifier">from wikipedia:</a> This is a kind of <em>active devices</em>(provide outpurs containing more power than their inputs), which means they need extra power supply.</p> <p><em>Common mode rejection ratio (CMRR)</em> of amp: <a href="https://en.wikipedia.org/wiki/Common-mode_rejection_ratio">wikipedia</a></p> <p><em>Analog-to-digital converter (ADC)</em> The device to convert a <strong>continuous</strong> analog signal(sound wave or sth) to a <strong>discrete</strong> digital signal. It involves some issure with sampling frequency, above which the information loss and <em>aliasing</em> may rise. The sample rate is determined by <em>Nyquist-Shannon sampling theorem</em>.</p> <p><em>Bus voltage</em> is the total voltage between power and ground(GND). It is the sum of the load voltage and the shunt voltage.<br/> <em>Load voltage</em> is the voltage going to the load. <em>Shunt voltage</em> is the voltage drop across the shunt resistor that is in series with the load.</p> <p><em>chassis</em>(ʃæ̱si) A <em>chassis</em> is the framework that a vehicle is built on.</p> <p>现在感觉真是越看不懂的越多，对于amp和hall element都有一个叫做zero offset的东西。 这个东西好像很深奥，然后对于不同的材料对于这个offset的modeling也不同。只能从主干入手了。旁支末节聊记于此，有心时再研究吧。</p>]]></content><author><name></name></author></entry><entry><title type="html">有关Raman光谱的有益探索</title><link href="https://toflamus.github.io/blog/2024/raman/" rel="alternate" type="text/html" title="有关Raman光谱的有益探索"/><published>2024-06-13T00:00:00+00:00</published><updated>2024-06-13T00:00:00+00:00</updated><id>https://toflamus.github.io/blog/2024/raman</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/raman/"><![CDATA[<h2 id="写在前面">写在前面</h2> <p>基本上我只看了数篇Wiki的百科就解决了诸多问题，当然感谢我的师兄师姐以及和我讨论的好兄弟们，最后让我缝缝补补出了一个大概的框架。</p> <h2 id="raman-stokes-scattering-is-not-stokes-shift">Raman-Stokes Scattering is NOT Stokes Shift</h2> <p>我想首先澄清一个概念，那就是Raman-Stokes Scattering 中的(Raman) Stokes Shift 并不是荧光粉的（Fluorescence）Stokes Shift，他们两个使用相同的名称，但是物理起源上并不一样。当我在使用Stokes以及Anti-Stokes effect想问题的时候就会出现一系列想不通的地方。现在可以说，这两个是两个不同的例子，因为其相似性，其中共用很多术语，然而其本质并不完全相同。</p> <h3 id="stokes-shift-fluorescence">Stokes shift (Fluorescence)</h3> <p>这是在原子物理中的一个著名的例子，<d-footnote>当时我们巧妙的跳过了这个部分，在杨福家老师的《原子物理学》应该对Stokes and anti-Stokes有简单讨论，因为公式比较复杂。我当时也没看。</d-footnote> 根据Wiki<d-cite key="stokes"></d-cite>，物理情景如下图所示：</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/stokes_shift-480.webp 480w,/assets/img/2024-06-13-raman/stokes_shift-800.webp 800w,/assets/img/2024-06-13-raman/stokes_shift-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/stokes_shift.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/stokes_antistokes-480.webp 480w,/assets/img/2024-06-13-raman/stokes_antistokes-800.webp 800w,/assets/img/2024-06-13-raman/stokes_antistokes-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/stokes_antistokes.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>在荧光材料中（或者不是荧光材料也行就是举个例子），当材料受到一个光子激发的就会跃迁到一个<strong>实际存在</strong><d-footnote>在下文Raman Stokes Scattering中这个能级在某些意义下不是实际存在的</d-footnote>的不稳定的高能级（态），然后这个能级会理论上应该会跃迁回之前的能级，并放出同样波长的光子。但是由于一些耦合效应其一方面可能会回到一个较高的能级然后放出一个波长改变的光子，在光谱上与入射光相比波长偏大(Stokes lines)， 另一方面其也可能放出一个波长较小的高能量光子（Anti-Stokes lines）。</p> <p>我的理解是这样的<d-footnote>不能确定是否正确</d-footnote>：吸收入射光会导致体系的稳态受到变化，于是周围环境会同时开始调整自己的电子结构使得体系能量下降。虽然吸收以及发射的时间尺度是非常小的（<em>fluorescence lifetime</em>），但是周围环境也会调整，那么此时就意味着其最低能量并不是之前的最低能量，放出一个光子之后并不会恢复到之前的状态。于是整体上放出光子的能量会变小，其余的能量会在这种周围环境的调整中损失掉，就是所谓 <strong><em>Vibrational Relaxation</em></strong>。在$10^7$个普通激发中只会出现1个Stokes line。</p> <p>类似的，反斯托克斯线就是因为一些机缘巧合，吸收的光子加上一些别的能量跃迁到了更高的能级然后回到原能级，放出比原始光子更高的能量的光子。Anti-Stokes效应的发生概率比Stokesline更少。</p> <blockquote> <p>那么，为什大量情况是回到原始态，只有极少量没有回到原始状态，也就是Stokes线呢？</p> </blockquote> <p>我的理解：考虑到因为量子态的变化是离散的，就意味着有一部分会进行Relaxation, 但是一部分(大部分)不会。统计上看起来进行了一些连续的变化，遵循B-M分布。于是具体到量子体系，在光子上那我们得到的不是连续的谱线而是离散的谱，并且大部分的光还是集中在原始能级的能量，只有少部分回到高能级。</p> <blockquote> <p>于是有产生了新的问题。对于Vibrational Relaxation具体是怎样的损失，又转化成了怎样的能量，能量的守恒是怎样的，这些问题就留给未来吧。</p> </blockquote> <h3 id="最大误解只有特定波长的激光才能做拉曼">最大误解：只有特定波长的激光才能做拉曼</h3> <p>于是知道一点拉曼的基本仪器的我产生了一个问题：</p> <blockquote> <p>拉曼光谱仪是仅仅使用一个激光光源的，但是问题在于如果想要看到Stokes谱线就意味着需要对应震动能级的特定波长的光，因为物质仅仅会吸收能量特定的光作然后被激发。但是世界上如此多物质，如此多化学键，如此多能级，对于屈指可数的商业激光器的波长，又怎么能胜任所有物质Raman的分析呢？</p> </blockquote> <p>其中必然有别的效应。</p> <h3 id="stokes-shift-raman">Stokes shift (Raman)</h3> <p>Raman中的Stokes效应和Anti Stokes效应是可以与荧光材料中的进行类比。也就是说都可以套用荧光材料中的理论进行解释。与荧光粉不同，他们认为这是一种Inelastic Scattering。在Raman效应中不是光子的吸收和释放，而是相互作用，有一点类似不理想的小球碰撞。套用与荧光产生的相同的理论，那么从量子的观点来看，我们可以认为Raman中的物质会被激发到一个“虚拟激发态”<em>Virtual state</em>, 它时间尺度很短，不能被测量，不是任何Operator的Eigen function，其被理解为一个概念性的态。<d-cite key="virtualstate"></d-cite>如下图<d-cite key="ramanspectroscopy"></d-cite>：</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/raman2-480.webp 480w,/assets/img/2024-06-13-raman/raman2-800.webp 800w,/assets/img/2024-06-13-raman/raman2-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/raman2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>然后在Virtual state的物质回Relax（1）回到原始态，放出与入射光相同的光子，被称为Rayleigh Scattering。（2）回到一个高能态，放出能量较低的光子，被称为Stokes Scattering。（3）被激发到一个高能虚拟态，然后回到原始态，被称为Anti-Stokes Scattering。</p> <p>这种奇怪的Virtual State可以解释一些现象了。比如为什么可以使用单色光源激发任意的物质。如果Virtual state的能量高低可以随便假设，那么我只要用一个能量合理的激光器（只要能量高于我待测物体的第一激发能级就可以），就可以实现Raman，并且现实中也确实如此。不论高能光子能量多少，我总是可以激发到一个假象的态中，然后进行再进行假象的Relaxation回到原始能级（Rayleigh）或者高一级的能级（Stokes）。于是，能量过高的激光有可能会破坏样品，根据F学长所说，Raman激光的高能性质有时候可以将待测反应物烧糊，所以在实际操作中可以调节激光的能量大小。</p> <blockquote> <p>但是Virtual State真的能拥有如此的高适应性吗，在物理学中真的可以随便假设其能级来fit激光器的能量，使得其可以进行“虚拟激发”这个物理过程吗？留给未来了。</p> </blockquote> <p>另外根据玻尔兹曼分布，因为Anti-Stokes line需要被激发到一个能量更高的态，所以其概率应该是非常低的。有一个关于Stokes以及Anti-Stokes线的比例的公式，或许可以用其解释一下Raman的峰的偏移程度。</p> \[\frac{I_{Stokes}}{I_{Anti_stokes}} = \frac{(\nu_0-\nu_v)^4}{(\nu_0-\nu_v)^4}e^{\frac{hc\nu_v}{k_BT}}\] <p>于是在Raman中Anti-Stokes的光谱往往和Rayleigh散射一起被过滤掉。仅仅留下相对比较多的Stokes lines。</p> <h2 id="raman光谱的基本原理以及与红外的异同">Raman光谱的基本原理以及与红外的异同</h2> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/raman-480.webp 480w,/assets/img/2024-06-13-raman/raman-800.webp 800w,/assets/img/2024-06-13-raman/raman-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/raman.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Wiki<d-cite key="ramanspectroscopy"></d-cite>的这一张图基本解释了为什么Raman和红外能够得到基本一致的谱图结果，Raman Shift在某种程度上蕴含了IR的图谱。举一个文献例子，可以参见这篇文献<d-cite key="C9SC05429D"></d-cite>，这篇文献中的IR 与Raman图谱基本完全重合。</p> <p>并且Raman Shift确实是一个Shift，是入射光和散射光的差值。在上图中，这个Shift的大小与红外图谱相对应。这解释了为什么Raman的图谱和红外的图谱的契合性那么好。</p> <p>\(\Delta \nu = (\frac{1}{\lambda}-\frac{1}{\lambda_0})\)<br/> $\lambda_0$ is the excitation wavelength,这个也是激光器的波长，但是这个可不是原本的红外测得的键的震动能级第一级与第0级之间的能量差的波长。</p> <p>在一个真正的Raman光谱仪器中，其会有大量的Rayleigh Scattering，根据上图，其波长是与入射激光相同的。我们一般通过一个Band-stop Filter<d-cite key="bandstop"></d-cite>。<d-footnote>可以通过程序或者一个电路元件实现（大概）</d-footnote>过滤掉大量Rayleigh lines。</p> <p>根据METTLER TOLEDO的<a href="https://www.mt.com/in/en/home/applications/L1_AutoChem_Applications/Raman-Spectroscopy/raman-scattering.html#:~:text=Rayleigh%20and%20anti%2DStokes%20scattering,which%20produces%20the%20Raman%20spectrum.">网站</a>其会筛掉Rayleigh 以及Anti-Stokes Lines，如前所述。</p> <p>根据F师兄说，从前的文章会同时测量IR以及Raman得到完整的谱学信息。一方面其图谱信息是相互对照，相互印证的，另一方面其也在活性上有互补性。因为有拉曼活性的不一定有红外活性，反之亦然。</p> <h3 id="rule-of-mutual-exclusion">Rule of mutual exclusion</h3> <blockquote> <p>Transitions which have large Raman intensities often have weak IR intensities and vice versa.<d-cite key="ramanspectroscopy"></d-cite></p> </blockquote> <blockquote> <p>The Raman effect is based on the interaction between the electron cloud of a sample and the external electric field of the monochromatic light, which can create an induced dipole moment within the molecule based on its polarizability.<d-cite key="ramanspectroscopy"></d-cite></p> </blockquote> <p><strong>红外测量的是偶极矩的变化，而拉曼测量的是偶极矩的极化</strong>。而Rule of mutual exclusion所说的是一个化学键的极化和变化往往一者强时另一者就弱。当一个强极化的键进行震动的时候，其由于电荷分布不均所以小距离的键长改变（震动）会导致偶极矩的较大变化；但在受到外场（光子）影响的时候，电子云形状（极化）的变化并不会改变多少。另外一方面，对于C=C双键这种类型的键，受到外场会导致比较强的电子云形状改变，但是震动是的长度改变对偶极矩的变化影响不明显。</p> <h3 id="spatial-resolution">Spatial Resolution</h3> <p>因为IR使用的是红外的自然光（比如灯泡），而Raman使用的是波长较短的激光系统，所以空间分辨率Raman更高一点。拉曼光谱仪也更贵。</p> <h3 id="summary-and-comparison">Summary and Comparison</h3> <p>From <a href="https://psiberg.com/ir-vs-raman-spectroscopy/">Web</a></p> <table> <thead> <tr> <th>Infrared Spectroscopy</th> <th>Raman Spectroscopy</th> </tr> </thead> <tbody> <tr> <td>Infrared spectroscopy involves the absorption of infrared radiation by molecules.</td> <td>Raman spectroscopy involves the scattering of laser light by molecular vibrations.</td> </tr> <tr> <td>It excites molecular vibrations involving dipole moments.</td> <td>It excites molecular vibrations without dipole moments.</td> </tr> <tr> <td>Infrared spectroscopy provides information about functional groups, bond types, and the molecular structure of the sample.</td> <td>Raman spectroscopy provides similar information to IR but can offer complementary details in some cases.</td> </tr> <tr> <td>It typically requires samples in the form of liquids, solids, or gases.</td> <td>It can work with samples in various states, including solids, liquids, or gases, and generally requires less sample preparation.</td> </tr> <tr> <td>Infrared spectroscopy is susceptible to water absorption bands in the spectra, which can impact the analysis.</td> <td>Raman spectroscopy is less affected by water interference, making it advantageous for samples with significant water content.</td> </tr> <tr> <td>It offers moderate sensitivity, allowing for the detection of relatively low concentrations of compounds.</td> <td>It generally exhibits lower sensitivity compared to IR, but this can be enhanced using techniques like surface-enhanced Raman spectroscopy (SERS).</td> </tr> <tr> <td>Infrared spectroscopy provides valuable information about the functional groups present, enables quantitative analysis, and is widely used in pharmaceutical and chemical industries.</td> <td>Raman spectroscopy offers complementary information to IR, making it suitable for samples with strong fluorescence and is commonly used in material science, geology, and biological studies.</td> </tr> <tr> <td>It can be affected by water interference, and accurate measurements require careful sample preparation.</td> <td>It has weaker signals compared to IR, limited applicability to certain molecules, and may experience interference from fluorescence in some cases.</td> </tr> <tr> <td>Infrared spectroscopy instruments are generally less expensive than Raman spectroscopy instruments due to simpler light sources and detectors.</td> <td>Raman spectroscopy instruments tend to be more expensive due to the need for laser systems and sophisticated detectors.</td> </tr> <tr> <td>It typically provides lower spatial resolution when used for imaging purposes.</td> <td>It can achieve higher spatial resolution, making it useful for Raman imaging and chemical mapping.</td> </tr> <tr> <td>It uses an infrared light source and can be performed using techniques such as FT-IR (Fourier-transform infrared) or dispersive IR spectroscopy.</td> <td>It requires a laser light source and a Raman spectrometer for data collection and analysis.</td> </tr> <tr> <td>Infrared spectroscopy has limited imaging applications due to its lower spatial resolution and often requires other techniques for imaging purposes.</td> <td>Raman spectroscopy is widely used in Raman imaging, enabling chemical mapping and visualization of specific components in a sample.</td> </tr> <tr> <td>It is commonly used in the pharmaceutical and chemical industries for identifying functional groups, detecting impurities, and characterizing polymers.</td> <td>It finds applications in material science, geology, and biological studies for analyzing crystalline structures, identifying minerals, and studying biological samples.</td> </tr> <tr> <td>Infrared spectroscopy provides information primarily from the near-surface region of the sample due to its limited penetration depth.</td> <td>Raman spectroscopy provides information from various depths within the sample, making it suitable for analyzing subsurface layers and bulk materials.</td> </tr> <tr> <td>It does not depend on the sample’s polarizability and is more sensitive to dipole moments in molecules.</td> <td>It intensity depends on the polarizability of the sample and can provide information about polarizability changes in molecular vibrations.</td> </tr> <tr> <td>Infrared spectroscopy is commonly used for identifying functional groups in organic compounds, detecting impurities in pharmaceuticals, and characterizing polymer materials.</td> <td>Raman spectroscopy is frequently employed in the analysis of crystalline materials, identifying minerals, studying biological samples, and assessing the composition of complex mixtures.</td> </tr> </tbody> </table> <h2 id="raman-仪器">Raman 仪器</h2> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/instrument-480.webp 480w,/assets/img/2024-06-13-raman/instrument-800.webp 800w,/assets/img/2024-06-13-raman/instrument-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/instrument.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>来自Wiki pedia</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/shift-480.webp 480w,/assets/img/2024-06-13-raman/shift-800.webp 800w,/assets/img/2024-06-13-raman/shift-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/shift.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>来自METTLER TOLEDO</p> <h2 id="raman读谱">Raman读谱</h2> <h3 id="总结图">总结图</h3> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/ramanspec-480.webp 480w,/assets/img/2024-06-13-raman/ramanspec-800.webp 800w,/assets/img/2024-06-13-raman/ramanspec-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/ramanspec.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="discussion-on-the-shift-of-raman-shift-difference-of-o-h-raman-peak-solute">Discussion on the shift of Raman shift: difference of O-H Raman peak solute</h3> <p>问题来自于一篇文章的Raman光谱<d-cite key="RN87"></d-cite>，这是一个对于水O-H键的Raman光谱分析。对于水的O-H键，其在加入电解质之后其峰总是会有一点点向高波数偏移，非常微小<d-footnote>在另外一篇文献中也看到了（Wang，20）</d-footnote>，但是还是有如下图：</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/waterraman-480.webp 480w,/assets/img/2024-06-13-raman/waterraman-800.webp 800w,/assets/img/2024-06-13-raman/waterraman-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/waterraman.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> a, The fitted Raman spectra of H2O, 4.5 m NaCF3SO3, Na–H2O–Al and Na–H2O–EG electrolytes from 2,500 to 4,000 cm−1 at 25 °C. </div> <p>请只关注图中的1，3部分。 其中最上方的第一部分是纯水的Raman光谱而第三部分是在含有钠盐和铝盐的溶液中。其中它使用了两个高斯分布进行拟合，分为弱O-H键和强O-H键。可以看到Raman 峰均偏向大波数，短波长的方向。并且一弱O-H键峰变宽强O-H键峰变窄。</p> <blockquote> <p>这个峰向短波方向移动现象是反直觉的。如果我们把峰的最高点认为是O-H键键能，会发现，随着阳离子溶剂化的增加，O-H键键能（峰的波数）增加。但是因为水中O和氧离子配位削弱了O-H键。从这个角度来讲，这个现象并不符合常规的分析。</p> </blockquote> <p>经过多方讨论，这个问题不能进行简单的定性分析。一方面放入盐之后Raman强度整体减少，根据其强度与浓度的正比性质，无论是强O-H键还是弱O-H键都减少了。</p> <p>并且如果从峰宽代表规律性来讲，峰更加宽的弱O-H作用更加无序。然而可能分成弱与强两种还有争议，因为有文献表明，O-H键的强弱可以通过多种分布来拟合。<d-cite key="SUN2009213"></d-cite></p> <p>但是不得不承认发生了少量的峰的偏移，这个现象也在别的文献中被报道（见下图）<d-cite key="Wang:20"></d-cite>，无论是强还是弱O-H键都发生了右移。那么是否阳离子的引入对于弱O-H键的影响比强O-H键多，因为其更好插入弱的氢键网络中。导致了更多的强O-H被保留下来。</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-13-raman/raman3-480.webp 480w,/assets/img/2024-06-13-raman/raman3-800.webp 800w,/assets/img/2024-06-13-raman/raman3-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-13-raman/raman3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <blockquote> <p>那么这个猜想是否意味着，溶剂化中心的周围存在巨大的强氢键网络？</p> </blockquote> <p>话说回来，对于这个峰移动的问题，其理论解释感觉应该比较繁杂，在刚才提到的第二篇文献中（Wang，20）我顺着其自引找到了”Known to all”的讨论峰的形状的影响因素的原文献，是一本讨论激光器的书（见Reference Reading 3）。此外这个吉林大学的课题组也发表了许多有关水的拉曼光谱的性质的文章。</p> <p>这个问题留给未来了。</p> <h2 id="raman的其他类别">Raman的其他类别</h2> <p>以上讨论的基本都是最为基础的震动拉曼，当然还有许多不同的拉曼：</p> <ul> <li>Spontaneous (or far-field) Raman spectroscopy</li> <li>Enhanced (or near-field) Raman spectroscopy</li> <li>Non-linear Raman spectroscopy</li> <li>Morphologically-Directed Raman spectroscopy</li> </ul> <p>留给未来了。</p> <h2 id="further-reading">Further Reading</h2> <p>有用文本，以后用到再说吧。</p> <ul> <li><a href="https://link.springer.com/article/10.1186/s11671-019-3039-2">Raman Techniques: Fundamentals and Frontiers</a></li> <li>Smith&amp;Dent, Modern Raman Spectroscopy: A Practical Approach.</li> <li>Linn F. Mollenauer, Jonathan C. White, Clifford R. Pollock，Tunable Lasers.（1992）</li> </ul>]]></content><author><name></name></author><category term="experiments"/><category term="insights"/><category term="longposts"/><category term="raman"/><category term="chinese"/><summary type="html"><![CDATA[我对拉曼探索许久，有太多误解，经过一番学习还是有许多不懂的地方，时间有限力有不逮仅总结一下那些地方我懂了那些地方我没懂，待以后需要之时再探索。其中我会澄清一些之前的误解，并给出为什么之前理解错误。文中大部分只有定性讨论，定量讨论之后再说吧。]]></summary></entry><entry><title type="html">一次有关primitive cell 的问题的讨论</title><link href="https://toflamus.github.io/blog/2024/primitivecell/" rel="alternate" type="text/html" title="一次有关primitive cell 的问题的讨论"/><published>2024-06-11T09:00:00+00:00</published><updated>2024-06-11T09:00:00+00:00</updated><id>https://toflamus.github.io/blog/2024/primitivecell</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/primitivecell/"><![CDATA[<p>问题描述：</p> <blockquote> <p>为什么钻石的Primitive Unit Cell（元胞）有两个C。Primitive cell 只允许一个Lattice point出现，这个lattice point 是一个几何概念与化学无关，这意味着在FCC的四面体中心的C与其他在角与面心的C的化学环境不同，于是现在问题来到如何证明其环境不同？</p> </blockquote> <ul> <li>这里直面关键问题： 什么叫环境相同？也就是Lattice的定义。</li> </ul> <blockquote> <p>A <strong><em>lattice</em></strong> is an infinite set of points defined by integer sums of a set of linearly independent primitive lattice vectors.<br/> Or, a <strong><em>lattice</em></strong> is an infinite set of vectors where addition of any 2 vectors in the set gives a third vector in the set.<br/> Or, a <strong><em>lattice</em></strong> is a set of points where the environment of any given point is equivalent to the environment of any other. ——The Oxford solid solid state basics.</p> </blockquote> <p>第三个定义有一点模糊。实际上环境相等的定义是只允许平移变换的。这可以从定义1得到。其需要整数的线性组合，意味着只有平移可以实现。</p> <p>那么如何看待这个钻石的结构呢？</p> <blockquote> <p>钻石的结构可以理解为一个面心立方沿着体对角线平移1/4。这意味着其与其他格点不是很对称。（Intuitive）<br/> ——来自我的一位好哥们学长</p> </blockquote> <blockquote> <p>钻石的结构如果重复性很好或者环境与格点一致，那么这个FCC中有四个C你一眼就应该看出对称性，你没看出来就说明重复的不是很好（Genius and inituitive） 更为细节的来讲，观察下图，其正四面体环境是需要旋转90°左右才能重合的，因此环境不同。<br/> ——来自我的一位合住的好哥们。</p> </blockquote> <blockquote> <p>等价的条件是周期性分布，明显正四面体C与角落C在对角线不是按照0.5个Conventional Unit Cell周期性分布的。<br/> ——来自我的一位好哥们。</p> </blockquote> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-11-primitivecell/Diamond-480.webp 480w,/assets/img/2024-06-11-primitivecell/Diamond-800.webp 800w,/assets/img/2024-06-11-primitivecell/Diamond-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-11-primitivecell/Diamond.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div>]]></content><author><name></name></author><category term="solidstate"/><category term="insights"/><category term="shortposts"/><category term="chinese"/><summary type="html"><![CDATA[起因是我不知道为什么Diamond中间有两个C，在朋友圈发了一圈获得许多insights，原因是因为对于Lattice point的定义不清楚，于是记之。]]></summary></entry><entry><title type="html">Setting up python environment</title><link href="https://toflamus.github.io/blog/2024/settingupenv/" rel="alternate" type="text/html" title="Setting up python environment"/><published>2024-06-07T09:00:00+00:00</published><updated>2024-06-07T09:00:00+00:00</updated><id>https://toflamus.github.io/blog/2024/settingupenv</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/settingupenv/"><![CDATA[<h2 id="installation-and-setup-of-vscode">Installation and setup of VScode</h2> <p>Visit the official website and download. Do not forget to add to path!.<br/> Click <a href="https://code.visualstudio.com/">here</a></p> <h3 id="setting-launchjson">Setting launch.json</h3> <p>Here is an answer from <a href="https://zhuanlan.zhihu.com/p/673525708">Zhihu</a></p> <p>Anyway for basic configuration, the VScode will write the <code class="language-plaintext highlighter-rouge">lanuch.json</code> for you.</p> <h3 id="settingsjson">settings.json</h3> <p><code class="language-plaintext highlighter-rouge">settings.json</code> is an important file where you can set the configurations of VS code by .json instead of click a lot of settings.</p> <h2 id="get-your-git">Get your git</h2> <p>From <a href="https://zhuanlan.zhihu.com/p/671365179">zhihu</a><br/> Official website: (Git)[https://git-scm.com/]</p> <p>Please choose the component:<br/> <code class="language-plaintext highlighter-rouge">(NEW!) Add a Git Bash Profile to Windows Terminal</code></p> <p>Everything else is just default configuration.</p> <p>Note that you may need to restart your VS code for using git</p> <h3 id="initialize-the-git">Initialize the git</h3> <p>Gets into Git CMD</p> <p>Add your user name and user email<br/> <code class="language-plaintext highlighter-rouge">git config --global user.name "&lt;your user name&gt;"</code><br/> <code class="language-plaintext highlighter-rouge">git config --global user.email "&lt;your email&gt;"</code></p> <h3 id="generate-ssh-keys-and-add-the-keys-to-your-github">Generate ssh keys and add the keys to your github</h3> <p>Generate ssh keys(still in GitCMD) <code class="language-plaintext highlighter-rouge">ssh-keygen -t -rsa</code></p> <p>Login to your GitHub account and find the SSH and GPG keys in your settings :</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-06-07-settingupenv/sshandgpgkeys-480.webp 480w,/assets/img/2024-06-07-settingupenv/sshandgpgkeys-800.webp 800w,/assets/img/2024-06-07-settingupenv/sshandgpgkeys-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-06-07-settingupenv/sshandgpgkeys.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Copy the information in the file <code class="language-plaintext highlighter-rouge">id_rsa.pub</code> and paste it to your github.</p> <p>To test if it works:</p> <p>Go to gitbash and run<br/> <code class="language-plaintext highlighter-rouge">ssh -T git@github.com</code></p> <h2 id="conda--anaconda">Conda &amp; anaconda</h2> <h3 id="set-up-conda-environment-and-how-to-use-conda">Set up conda environment and how to use conda</h3> <h4 id="install">Install</h4> <p><a href="https://link.zhihu.com/?target=https%3A//conda.io/docs/">Conda</a> Official web</p> <p><a href="https://www.anaconda.com/download">Anaconda download</a></p> <p>Open <strong>Anaconda Prompt</strong></p> <p><code class="language-plaintext highlighter-rouge">conda --version</code></p> <p>Update conda<br/> <code class="language-plaintext highlighter-rouge">conda update conda</code></p> <h4 id="creating-environments">Creating environments</h4> <p>Conda allows you to create separate environments, each containing their own files, packages, and package dependencies. The contents of each environment do not interact with each other.</p> <p>The most basic way to create a new environment is with the following command:</p> <p><code class="language-plaintext highlighter-rouge">conda create -n &lt;env-name&gt; (&lt;package_names&gt;)</code></p> <p>To add packages while creating an environment, specify them after the environment name:</p> <p>Ex: <code class="language-plaintext highlighter-rouge">conda create -n myenvironment python=3.12.3</code></p> <p>For more information on working with environments, see <a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">Managing environments</a>.</p> <h4 id="listing-environments">Listing environments</h4> <p>To see a list of all your environments:</p> <p><code class="language-plaintext highlighter-rouge">conda info --envs</code></p> <p>A list of environments appears, similar to the following:</p> <p>`conda environments:</p> <p>base /home/username/Anaconda3<br/> myenvironment * /home/username/Anaconda3/envs/myenvironment`</p> <p><strong>Tip</strong></p> <p>The active environment is the one with an asterisk (*).</p> <p>To change your current environment back to the default <code class="language-plaintext highlighter-rouge">base</code>:</p> <p><code class="language-plaintext highlighter-rouge">conda activate</code></p> <p><strong>Tip</strong></p> <p>When the environment is deactivated, its name is no longer shown in your prompt, and the asterisk (*) returns to <code class="language-plaintext highlighter-rouge">base</code>. To verify, you can repeat the <code class="language-plaintext highlighter-rouge">conda info --envs</code> command.</p> <h4 id="installing-packages">Installing packages</h4> <p>You can also install packages into a previously created environment. To do this, you can either activate the environment you want to modify or specify the environment name on the command line:</p> <ul> <li>via environment activation <ul> <li><code class="language-plaintext highlighter-rouge">conda activate myenvironment</code></li> <li><code class="language-plaintext highlighter-rouge">conda install matplotlib</code></li> </ul> </li> <li>via command line option<br/> <code class="language-plaintext highlighter-rouge">conda install --name myenvironment matplotlib</code></li> </ul> <p>For more information on searching for and installing packages, see <a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-pkgs.html">Managing packages</a>.</p> <h4 id="via-command-line-option">via command line option</h4> <p><code class="language-plaintext highlighter-rouge">conda install --name myenvironment matplotlib</code></p> <p>For more information on searching for and installing packages, see <a href="https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-pkgs.html">Managing packages</a>.</p> <h4 id="clone-environment">Clone environment</h4> <p><code class="language-plaintext highlighter-rouge">conda create --name &lt;new_env_name&gt; --clone &lt;copied_env_name&gt;</code></p> <h4 id="remove-environment">Remove environment</h4> <p><code class="language-plaintext highlighter-rouge">conda remove --name &lt;env_name&gt; --all</code></p> <h3 id="anacondacondapipvirtualenv的区别"><strong>Anaconda、conda、pip、virtualenv的区别</strong></h3> <h4 id="-anaconda"><strong>① Anaconda</strong></h4> <p>Anaconda是一个包含180+的科学包及其依赖项的发行版本。其包含的科学包包括：conda, numpy, scipy, ipython notebook等。</p> <h4 id="-conda"><strong>② Conda</strong></h4> <p>conda是包及其依赖项和环境的管理工具。</p> <p>▪ 适用语言：Python, R, Ruby, Lua, Scala, Java, JavaScript, C/C++, FORTRAN。</p> <p>▪ 适用平台：Windows, macOS, Linux</p> <p>▪ 用途：</p> <p>① 快速安装、运行和升级包及其依赖项。</p> <p>② 在计算机中便捷地创建、保存、加载和切换环境。</p> <blockquote> <p>如果你需要的包要求不同版本的Python，你无需切换到不同的环境，因为conda同样是一个环境管理器。仅需要几条命令，你可以创建一个完全独立的环境来运行不同的Python版本，同时继续在你常规的环境中使用你常用的Python版本。——</p> </blockquote> <p>▪ conda为Python项目而创造，但可适用于上述的多种语言。</p> <p>▪ conda包和环境管理器包含于Anaconda的所有版本当中。</p> <h2 id="additional-extensions">Additional extensions</h2> <ul> <li>Python extensions <ul> <li>python</li> <li>python debugger</li> <li>pylance</li> </ul> </li> <li> <p>Jupyter extensions</p> </li> <li> <p>C/C++</p> </li> <li> <p>Ruby</p> </li> <li> <p>LaTeX extensions</p> </li> <li>Github extensions <ul> <li>GitHub Pull Request extensions</li> <li>Open in GitHub</li> </ul> </li> <li>Markdown extensions <ul> <li>Markdown all in one</li> <li>Markdown PDF</li> <li>Markdown priview enhenced</li> <li>Markdownlint</li> </ul> </li> <li>SSH <ul> <li>Remote SSH</li> <li>Remote SSH: Editing Configurations files</li> <li>Remote explorer</li> </ul> </li> <li>AI <ul> <li>Tabnine</li> <li>GitHub copilot</li> </ul> </li> <li>Other <ul> <li>Background</li> <li>Paste image</li> <li>Rainbow CSV</li> <li>vscode-pdf</li> </ul> </li> </ul> <h2 id="connect-remotely-to-server">Connect remotely to server</h2> <p>A good article in <a href="https://zhuanlan.zhihu.com/p/655276102">zhihu</a></p>]]></content><author><name></name></author><category term="setupenv"/><category term="setupenv"/><category term="longposts"/><summary type="html"><![CDATA[Setting up VScode with git and build an envrionment with anoaconda]]></summary></entry><entry><title type="html">ICC-introduction</title><link href="https://toflamus.github.io/blog/2024/icc01/" rel="alternate" type="text/html" title="ICC-introduction"/><published>2024-05-26T09:00:00+00:00</published><updated>2024-05-26T09:00:00+00:00</updated><id>https://toflamus.github.io/blog/2024/icc01</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/icc01/"><![CDATA[<p>What it can do?</p> <ul> <li>Optimal structure</li> <li>Energies</li> <li>Properties(dipole moment, polarizability, NMR coupling constants)</li> <li>Reaction kinetics</li> <li>Propogates with time</li> <li>Interactions and reactions</li> </ul> <h2 id="fundamental-issues">Fundamental issues</h2> <p><strong>Solving the many-body problem</strong> with a computer.</p> <p>Computers can do:</p> <ul> <li>Mathematical operations</li> <li>Branching (N&gt;10)</li> <li>Looping</li> <li>Reading and writing data</li> </ul> <h2 id="describe-the-system">Describe the system</h2> <p>There are 4 problems to consider:</p> <ul> <li>System description: what is the fundamental units(particles) and how many are them?</li> <li>Initial conditions: particles positions and velocities(defined by dynamical equations, becareful of the isomers place your atoms in the right place).</li> <li>Interactions: the force</li> <li>Dynamical equations</li> </ul> <p>Hierarchy:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-26-icc01/hierarchy-480.webp 480w,/assets/img/2024-05-26-icc01/hierarchy-800.webp 800w,/assets/img/2024-05-26-icc01/hierarchy-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-26-icc01/hierarchy.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="fundamental-forcespotential">Fundamental forces(potential)</h2> \[\mathbf F(\mathbf r) = -\frac{\partial \mathbf V}{\partial \mathbf r}\] <p>There are 4 fundamental interactions, weak, strong, electromagnetic, gravitational.</p> <p>The weak and electromagnetic can be combined and computed by <strong><em>Q.E.D.</em></strong>.<br/> <strong>Q.E.D.+strong interactions = Standard model</strong></p> <h2 id="dynamical-equations">Dynamical equations</h2> <p>Domains</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-26-icc01/dynamic_domains-480.webp 480w,/assets/img/2024-05-26-icc01/dynamic_domains-800.webp 800w,/assets/img/2024-05-26-icc01/dynamic_domains-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-26-icc01/dynamic_domains.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p><strong>Sometimes relativistic mechanics, quantum effects, or a combinations of them needs to be considered.</strong></p> <p>There are some detailed discussion on the equations please refer to the book page 8.</p> <h2 id="solve-the-dynamic-equations">Solve the dynamic equations</h2> <p>We cannot solve the dynamic equations analytically with there are &gt;= 3 bodies. <em>Classic 3-body problem</em>.</p> <p><strong>Verlet algorithm</strong></p> \[r_{i+1} = r_i + v_i(\Delta t) + \frac{1}{2}a_i(\Delta t)^2 + \frac{1}{6}b_i(\Delta t)^3+ ...\] \[r_{i-1} = r_i - v_i(\Delta t) + \frac{1}{2}a_i(\Delta t)^2 - \frac{1}{6}b_i(\Delta t)^3+ ...\] \[r_{i+1} = (2r_i - r_{i-1}) + a_i(\Delta t)^2 + ...\] <p>All the odd terms disappear.</p> <p>Hyperparameter: $\Delta t$<br/> Just for reference: Hydrogen vibrations ocur with a typical frequency of $3000cm^{-1}$ (Just think about IR spectroscopy diagram C-H). corresponding to $~10^{14}s^{-1}$. So it is resonable to choose the time scale of $\Delta t = 10{-15} s$</p> <h2 id="sov-separation-of-variables">SOV separation of variables</h2> <p><strong>Step 1:</strong></p> <p>Introduce the <strong><em>center of mass</em></strong> system.</p> <ul> <li>For a 2-body system, we can separate the variables by introducing the center of mass system. This is not valid for 3-or-more-body systems. Approximations needs to be made.</li> <li>Born-Oppenheimer(infinitely heavy nuclei)</li> <li>Hartree-Fock: Average repulsion of electrons</li> </ul> <h3 id="separating-time-and-space-variables">Separating time and space variables</h3> <p>General form:</p> <p>\(\mathbf H(\mathbf r, t)\Psi(\mathbf r, t) = i \frac{\partial \Psi(\mathbf r,t)}{\partial t}\)<br/> \(\mathbf H(\mathbf r, t) = \mathbf T(\mathbf r) + \mathbf V(\mathbf r, t)\) Note: There is no time dependence in momentum operater. $\mathbf T$ stands for kinetic energy and $\mathbf V$ stands for potential energy.</p> <p>For a bounded system, we because of the postulate of isotropic of time. The potential which is a combination of fundamental forces can be time invariant.</p> \[\mathbf H(\mathbf r, t) = \mathbf H(\mathbf r) = \mathbf T(\mathbf r) + \mathbf V(\mathbf r)\] <p>\(\mathbf H(\mathbf r)\Psi(\mathbf r, t) = E(\mathbf r)\Psi(\mathbf r, t)\)<br/> Note: the $\mathbf H(\mathbf r)$ is an operater that act on wave function. the $E(\mathbf r)$ is just a constant. This actually means the energy is an eigenvalue of time-invariant Schudinger equation.</p> \[\mathbf H(\mathbf r)\Psi(\mathbf r, t) = E(\mathbf r)\Psi(\mathbf r, t) = i \frac{\partial\Psi(\mathbf r, t)}{\partial t}\] \[\Psi(\mathbf r, t) = \Psi(\mathbf r)e^{-iEt}\] <h3 id="separating-nuclear-and-electronic-variables">Separating nuclear and electronic variables</h3> \[H = T + V\] <p>Assuming a N-partical system.</p> \[\mathbf T = \sum_{i = 1}^{N}\mathbf T_i = -\sum_{i = 1}^{N}\frac{1}{2m_i}\nabla ^2_i\] \[\mathbf V = \sum_{i &gt; j} V_{ij}\] <p>If we denote the position of the nuclear coordinate with $\mathbf R$ and electron nuclear with $\mathbf r$:<br/> \(\mathbf H_{tot}\Psi_{tot}(\mathbf R, \mathbf r) = E_{tot}\Psi_{tot}(\mathbf R, \mathbf r)\)</p> <p>\(\mathbf H_{tot} = \mathbf H_{e} + \mathbf T_{n}\)<br/> Here the \mathbf H_{e} is not only the Hamiltonian of electron but a large combination of electron and nucleus interactions.<br/> \(\mathbf H_{e} = \mathbf T_{e} + \mathbf V_{ne} + \mathbf V_{nn} +\mathbf V_{ee}\)</p> <p>Why we split the total Hamiltonian into $\mathbf H_e and \mathbf T_n$. The reason is that we will not take the famous assumption, <strong><em>Born-Oppenheimer approximation</em></strong>: <em>the electronic wave function thus depends parametrically on the nuclear coordinates since it only depends on the position of the nuclei, not on the momentum</em>. This means that the electrons only goes with the nuclei, for electrons the nuclei is so heavy and slow that it seems stationary. This means:</p> <ul> <li> <p>We can provide a potential energy surface around a nuclei(Actually most of people just take this for granted, especially sb study chemistry and have seen so many potential diagrams).</p> </li> <li> \[\Psi_{tot}(\mathbf R, \mathbf r) = \Psi_n(\mathbf R)\Psi_e(\mathbf R, \mathbf r)\] </li> </ul> <p>And the original$\mathbf H_{tot}\Psi_{tot}(\mathbf R, \mathbf r) = E_{tot}\Psi_{tot}(\mathbf R, \mathbf r) $ equation can be separated into 2 equations:<br/> \(\mathbf H_{tot}\Psi_n(\mathbf R)\Psi_e(\mathbf R, \mathbf r) = E_{tot}\Psi_n(\mathbf R)\Psi_e(\mathbf R, \mathbf r)\) \((\mathbf H_{e} + \mathbf T_{n})\Psi_n(\mathbf R)\Psi_e(\mathbf R, \mathbf r) = E_{tot}\Psi_n(\mathbf R)\Psi_e(\mathbf R, \mathbf r)\) Assuming that $E_{tot} = E_e + E_{n,e}$</p> <ul> <li> <p>\(\mathbf H_e \Psi_e(\mathbf R, \mathbf r) = E_e(\mathbf R)\Psi_e(\mathbf R, \mathbf r)\)<br/> Note again that the $\mathbf H_e$ is not only about electrons. It seems that the nucleus is treated a purely stable and the energy is only composed of potential and velocity of electrons.</p> </li> <li> \[(\mathbf T_n + E_e(\mathbf R)) \Psi_n(\mathbf R) = E_{tot} \Psi_n(\mathbf R)\] </li> </ul> <p><strong>Generally</strong></p> <p>\(\mathbf H = \sum_i \mathbf h_i\) \(\mathbf \Psi_i = \prod_i \phi_i\) \(E = \sum_i \epsilon_i\)</p> <h2 id="hydrogen-liked-atoms1-e">Hydrogen liked atoms(1 e)</h2> <ul> <li>Solve Schrodinger equation with $\mathbf V(r_{1,2} = \frac{q_1q_2}{r_12})$</li> <li>Quantum effect(n,l,m)comes from the zero-point of triangular functions.</li> <li>Orthogonalality of the orbitals: <ul> <li> \[\langle \Psi_{n,l,m}| \Psi_{n^{\prime},l^{\prime},m^{\prime}}\rangle = \delta_{n,n^{\prime}}\delta_{l,l^{\prime}}\delta_{m,m^{\prime}}\] </li> </ul> </li> </ul> <h2 id="helium-atom2-es">Helium atom(2 es)</h2> <p>Different from hydrogen atom there 2 electrons a series of problems may raise.</p> <h3 id="symmetry-of-the-wavefunctions">Symmetry of the wavefunctions</h3> <p>For indistinguishable particles, no matter it is Fermions or Bosons, probability should not change:</p> \[|\psi(2,1)|^2 = |\psi(1,2)|^2\] <p>This means the wave function can be symmetric(<strong>Bosons</strong>, interger spins) or anti-symmetric(<strong>Fermions</strong>, half interger spins)</p> <ul> <li>Symmetric: $\psi(2,1) = \psi(1,2)$</li> <li>Anti-symmetric: $\psi(2,1) = -\psi(1,2)$</li> </ul> <p>If we <strong><em>do not consider the interaction of each pair of particles</em></strong>. The system wavefunctions are:<br/> \(\psi (1,2,3,...n) = \psi (1)\psi (2)\psi (3)...\psi (n)\)</p> <p>Furthermore, if we have 2 quantum states $a$ and $b$, then the wave function can be expressed as a linear combination of the 2 parts:</p> <p>\(\psi_I = \psi_a(1)\psi_b(2)\) \(\psi_{II} = \psi_a(2)\psi_b(1)\)</p> <ul> <li>Symmertric: \(\psi_s = \frac{1}{\sqrt 2}(\psi_a(1)\psi_b(2)+\psi_a(2)\psi_b(1))\)</li> <li>Anti-symmetric: \(\psi_{as} = \frac{1}{\sqrt 2}(\psi_a(1)\psi_b(2)-\psi_a(2)\psi_b(1))\)</li> </ul> <p>Look carefully at the anti-symmetric function, it can be expressed in a form just as determinant. This is called <strong><em>Slater determinant</em></strong>:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-26-icc01/slater-480.webp 480w,/assets/img/2024-05-26-icc01/slater-800.webp 800w,/assets/img/2024-05-26-icc01/slater-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-26-icc01/slater.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Note: Only the $\mathbf V_{ne}$ is considered in this expression. $\mathbf V_{ee}$ is not considered.</p> <p>Then for the case of electrons:<br/> <strong>Electron is Fermion</strong></p> <h3 id="electron-interactions">Electron interactions</h3> <p>$\mathbf V_{ee}$ is hard to measure. A better approximation can be obtained by taking the average repulsion between the electrons into account when determining the orbitals, a procedure known as the <strong><em>Hartree–Fock</em></strong> approximation.</p> <p>Hartree–Fock method is not accurate enough(99%). There is still a remaining term called the <strong><em>correlation energy</em></strong> This term takes instaneous interaction into account.</p> <h2 id="chemistry">Chemistry</h2> <p><strong>Chemistry is knowing the energy as a function of the nuclear coordinates. Born-Oppenheimer approximation</strong><br/> <strong>Properties are knowing how the energy changes upon adding a perturbation.</strong></p>]]></content><author><name></name></author><category term="computationalchem"/><category term="computationalchem"/><category term="longposts"/><summary type="html"><![CDATA[Introduction to computational chemistry. Notes of Chapter01]]></summary></entry><entry><title type="html">备忘录|当时我是如何选购电脑的</title><link href="https://toflamus.github.io/blog/2024/compu1/" rel="alternate" type="text/html" title="备忘录|当时我是如何选购电脑的"/><published>2024-05-25T21:25:00+00:00</published><updated>2024-05-25T21:25:00+00:00</updated><id>https://toflamus.github.io/blog/2024/compu1</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/compu1/"><![CDATA[<h2 id="电脑选取">电脑选取</h2> <p>选取还是主要看了一堆bilibili的视频</p> <p>主要选择还是在华为，荣耀，联想三家中选择。因为这台电脑想要刷Linux以及增加固态硬盘，华为以及荣耀的扩展性实在是太差了。机身虽然轻一点，但是两个USB 一个HDMI 一个TYPE-C实在是让之后的可能性大大降低。虽然会有机械革命，华硕等电脑脑厂商，但是我希望能够找一个品控好一点的这样不至于赌博。</p> <p>这是我选择的电脑的参数设置，不过我的是16寸的就是了。</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-25-compu1/image-480.webp 480w,/assets/img/2024-05-25-compu1/image-800.webp 800w,/assets/img/2024-05-25-compu1/image-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-25-compu1/image.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h2 id="显卡">显卡</h2> <p>因为我选择的这个电脑的可扩展性非常强，有外置显卡接口，一个额外的固态硬盘槽，并且拥有可以拆卸更换的内存条。（具体时看up主“笔吧测评室”）的测评的。我去网上搜索了一下，一个显卡扩展坞的框架大概1000元左右，然后一个非公版Ge Force RTX 4060显卡大概2600左右，于是自己组装一个可移动显卡大概3600只贵了600块左右。</p> <p><strong>公版显卡和非公版显卡的一点信息：</strong></p> <ol> <li>功能不同，非公版相比较于公版的显卡来说，会增加了很多实用性的一些功能，比如一键超频。</li> <li>性能不同，非公版显卡的性能要比公版显卡的性能更强一些，尤其是一些旗舰级的非公版显卡，在同芯片组的前提下，其性能方面依旧要比公版显卡性能提升10%左右。</li> <li>特点不同，公版显卡的特点是稳定性比较强，制作精良，买显卡在用料方面是比较足的，公版的特点就是稳定为前提。而非公版显卡它的特点主要就是相比较于公版显卡来说，在性能方面提升会比较大。</li> </ol> <p>非公版又分两种，一种是采用公版PCB设计的“伪非公”，相较公版来说性能上没有太大的差异，一般是在一些细节和散热器上做出更改，并且对显卡核心做小幅度超频，性能上较公版差异不大，而散热上会有一定提高。</p> <p>对于选择公版还是非公版，荐选择非公版是更稳妥的做法。因为哪怕是“伪非公”也各大厂商手里经过出厂的小幅超频和升级散热，性能较公版会有小幅度提升。而公版的做工和用料虽然都非常优秀，但作为参考设计更多是以稳定为前提。另外，一些旗舰级非公显卡的性能提升非常大。</p> <h2 id="固态硬盘ssd">固态硬盘SSD</h2> <p>这次选取电脑也简单了解了一下SSD的相关知识，认识了一个叫“天才赵德柱”的up。他的视频还都挺通俗易懂的。</p> <p><strong>相关概念</strong></p> <ul> <li>固态硬盘</li> <li>主控制板</li> <li>缓存（模拟缓存）</li> <li>闪存芯片 <ul> <li>（SLC,MLC,TLC,QLC…, ）</li> <li>利用电子填充来储存信息，有相比于机械硬盘较短的使用寿命但是较快的速度</li> <li>4K 读写与顺序读写速度</li> <li>颗粒：原厂颗粒和其他黑、白片</li> </ul> </li> <li>NVME协议</li> <li>M.2接口</li> </ul> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-25-compu1/SSD-480.webp 480w,/assets/img/2024-05-25-compu1/SSD-800.webp 800w,/assets/img/2024-05-25-compu1/SSD-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-25-compu1/SSD.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>图片详见<a href="https://www.bilibili.com/video/BV1XW4y187Nc/?spm_id_from=333.337.search-card.all.click&amp;vd_source=c60ebf464c501f80e2b8630acfe412e7">bilibili</a></p>]]></content><author><name></name></author><category term="memo"/><category term="memo"/><category term="shortposts"/><summary type="html"><![CDATA[记录一下选购电脑时的考量以及学习的内容和搜集的信息]]></summary></entry><entry><title type="html">Mass transfer and diffusion</title><link href="https://toflamus.github.io/blog/2024/ff_mt/" rel="alternate" type="text/html" title="Mass transfer and diffusion"/><published>2024-05-13T09:00:00+00:00</published><updated>2024-05-13T09:00:00+00:00</updated><id>https://toflamus.github.io/blog/2024/ff_mt</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/ff_mt/"><![CDATA[<h2 id="basic-concepts-and-definitions">Basic concepts and definitions</h2> <p>Before we start let just review some concepts:</p> <p>There are 2 kinds of diffusion we consider in the system.</p> <p><strong><em>molecular diffusion</em></strong> by <strong>random and spontaneous microscpoic movement of molecules</strong> of thermo motion occurs in fluid that is <strong>stagnant or in laminar motion</strong>. The process is <strong>slow</strong>.<br/> <strong><em>eddy diffusion</em></strong> by <strong>random macroscopic fluid motion</strong> occurs when <strong>fluid mixing in a turbulent motion</strong>. This is a fast process.</p> <p>Also, mass transfer contains convection.<em>convection</em> by bulk flow.</p> <p>$J$: molar diffusion flux density<br/> $N$：molar flux density</p> <h2 id="ficks-law-and-mass-balance">Fick’s law and mass balance</h2> <p>To start with, if we do not go from <em>Maxwell-Stefan’s theory</em> everything starts with 2 basic thoughts. We use different forms of the 2 equations here and there. Please remember this in your mind <strong>Mass transport analogues to heat transfer</strong> in many ways!</p> <h3 id="ficks-law-and-mutual-diffusivity">Fick’s law and mutual diffusivity</h3> <p>We just assume that a driving force result in a linear responding. Which is exactly the <em>Fick’s law</em><br/> \begin{equation}<br/> J_A = -D_{AB}\nabla c_A \end{equation}</p> <p>\begin{equation} J_B = -D_{BA}\nabla c_B\end{equation}<br/> \begin{equation} D_{AB} = D_{BA}\end{equation}</p> <p>$D$ is in $m^2/s$, $c$ is in $[anyunit]/m^3$</p> <p>There are other forms of Fick’s law: \begin{equation} J_A = -cD_{AB}\nabla x_A\end{equation}<br/> or<br/> \begin{equation}j_A = -\rho D_{AB}\nabla w_A\end{equation}</p> <p>$w_A$ is the mass fraction of A. $\rho * w = kg/m^3* kg(A)/kg(solution) = m_A/v_{solution}$</p> <h3 id="mass-balance-in-a-control-volume">Mass balance in a control volume</h3> <p>Consider a classic mass balance problem in a controled volume.</p> <p>\begin{equation}\frac{\partial c_A}{\partial t} = \nabla\end{equation}</p> <h3 id="ficks-second-law">Fick’s second law</h3> <p>Combine the first 2 equations, we have the Fick’s second law:</p> <p>\begin{equation}\frac{\partial c_A}{\partial t} = - \nabla^2 c_A\end{equation}</p> <h3 id="species-velocities">Species velocities</h3> <p>$\mathcal Def$: molar avearge mixture velocity</p> <p>\begin{equation}v_M = \frac{N}{c} = \frac{\sum N_i}{c}\end{equation}</p> <p>$\mathcal Def$: velocity of species i in terms of $N_i$</p> <p>\begin{equation}v_M = \frac{N_i}{c_i}\end{equation}</p> <p>Thus<br/> \begin{equation}v_M = \frac{\sum N_i}{c} = \sum\frac{c_i}{c}\frac{ N_i}{c_i} = \sum x_i v_i\end{equation}</p> <p>$\mathcal Def$: Diffusion velocity</p> <p>\begin{equation}v_{i_D} = \frac{J_i}{c_i} = \frac{N_i - N_{i,conv}}{c_i} = v_i - v_M \end{equation}</p> <p>Note: $N_{i,conv} \neq N$</p> <p>\begin{equation}<br/> v_i = v_M+v_{i_D} \end{equation}<br/> \begin{equation}<br/> N_i = c_iv_M+c_iv_{i_D} \end{equation}</p> <p>For a binary system,<br/> \begin{equation}<br/> N_A = \frac{n_A}{A} = x_AN- cD_{AB}\nabla{x_A} \end{equation}</p> <h3 id="equimolar-conterdiffusionemd">Equimolar Conterdiffusion(EMD)</h3> <p>EMD means that the molar fluxes are equal but in opposite direction. The result predicts linearity in mole fraction and distance.<br/> This a little bit like <em>*Distillation</em> process with operation line is a straight line. The contration profile is just as the graph shows.</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-13-ff_mt/image-480.webp 480w,/assets/img/2024-05-13-ff_mt/image-800.webp 800w,/assets/img/2024-05-13-ff_mt/image-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-13-ff_mt/image.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="unimolecular-diffusion-umd">Unimolecular Diffusion (UMD)</h3> <p>In this case, there is only 1 species moving, the other species stay still.</p> <h2 id="diffusivity-in-various-situations">Diffusivity in various situations</h2> <p>There are many both empirical and theoretical relationships for estimation of diffusivity in Gas nonelecteolyte liquid, electrolyte, biological solutions, different solids.</p> <h2 id="fluid-fluid-mass-transfer">Fluid-fluid mass transfer</h2> <h3 id="film-theory">Film theory</h3> <p>This is the theory for a real mass transfer case like a thin film, such as Stagnent layer of a laminar sublayer (层流边界层的传质).<br/> Becareful that <strong>Phase equilibrium</strong> exist between stagnent layer and the 2 sides which means that there is a sharp change of concentration in the boundary of film.</p> <h3 id="penetration-theory">Penetration Theory</h3> <p>This is a different model for better estimation than film theory.</p> <p>The film is no more stagnent but replaced by Boussinesq eddies. This means the transport can no more be approximated by an integration in the case of film theory but a PDE problem needs to be solved to get the time response. A typical boundary condition is the <strong>semi-infinite medium</strong>.</p> <ul> <li>An element of liquid initially at $c_{Ab}$ is suddenly exposed to $c_i$, the interface contration.</li> <li>All elements have the same contact time.</li> <li>Thick film diffusion, infinite liquid and short contact time.</li> <li>In the direction of diffusion($z$): diffusion &gt; convection.</li> <li>In the direction of bulk flow ($x$): convection &gt; diffusion.</li> </ul> <p>The model is useful for bubbles, droplets, or random packing interfaces. One can estimate the contact time in this theory and there are models to first estimate the contact time and use the result to predict the diffusion process.</p> <h3 id="surface-renewal-theory">Surface-Renewal Theory</h3> <p>The Penetration model assumes a fixed contact time but for bubbles with different sizes, the contact time is not the same. There should be a contact time distribution.</p> <ul> <li>Liquid elements now exposed at a surface that would be renewed at random times.</li> <li>The probability of any element of surface becoming destroyed and mixed with bulk of the fluid is independent of the age of the element.</li> </ul> <p>$\mathcal Def$: Rate of production of fresh [surface per unit total area]</p> <p>$f(t)$: contact time distribution for liquid elements at surface rate of production.</p> <p>\(Number\ or\ fraction\ of\ molecules = fraction\ from\ previous\ interval - fraction\ renewed\)<br/> This equation is analogous to the equation for CSTR reactor.</p> <p>\begin{equation} f(t)dt = f(t-dt)dt- sf(t-dt) \end{equation}</p> <p>\begin{equation} \frac{df(t)}{dt} = -sf(t) \end{equation}</p> <p>After normalization: $\int_0^\infty f(t) = 1$</p> <p>\begin{equation} f(t) = se^{-st} \end{equation}</p> <h3 id="2-film-theory--overall-mass-transfer-coefficient">2-film theory &amp; overall mass transfer coefficient</h3> <p>This is just the same of dense member mass transfer with consideration of phase equilibrium.We can define permeability or permeance.</p> <ul> <li>Steady dtate</li> <li>Const flux</li> <li>Stagnent films exist</li> <li>2 phase are in eq at interphase</li> </ul> <h2 id="general-driving-forces--onsager-maxwell-stefan-equations">General driving forces &amp; (Onsager-)Maxwell-stefan equations</h2> <p>There are other driving forces beyond concentration gradient.</p>]]></content><author><name></name></author><category term="masstransfer"/><category term="masstransfer,"/><category term="longposts"/><summary type="html"><![CDATA[Introduction to fluid-fluid mass transfer with comparison between different models and an introduction to Maxwell Stefan law]]></summary></entry><entry><title type="html">A detailed example of Fast Fourier Transform</title><link href="https://toflamus.github.io/blog/2024/fft/" rel="alternate" type="text/html" title="A detailed example of Fast Fourier Transform"/><published>2024-05-02T09:00:00+00:00</published><updated>2024-05-02T09:00:00+00:00</updated><id>https://toflamus.github.io/blog/2024/fft</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/fft/"><![CDATA[<h2 id="discrete-fourier-transform">Discrete Fourier Transform</h2> <p>I suppose nobody can get away of Discrete Fourier Transform(DFT) when talking about Fast Fourier Transform(FFT). Let’s have a quick look.</p> <p>A DFT comes from continuous Fourier Transform:</p> \[\hat f(\omega) = \mathscr{F}\{f(t)\} = \int_{-\infty}^{+\infty} f(\tau) e^{-i\omega t} dt\] <p>For a discrete version of FT:</p> \[\hat f[k] = \frac{1}{N}\sum_{n=0}^{N-1}f[n]e^{-\frac{2\pi i k n }{N}}\] <p>Take a detailed look at the $k = 0$ case.</p> <p>\(\hat f[k = 0] = \frac{1}{N}(f[0]+f[1]+f[2]+...+f[N-1])\) \(\hat f[k = 0] = \frac{1}{N}\sum_{n=0}^{N-1} = \mu = mean\)</p> <p>In the background of circuit, this $k = 0$ term is also called a DC-offset.</p> <p>\(\hat f[k = 1] = \frac{1}{N}(f[0]+f[1]e^{(\frac{-2\pi i }{N})}+f[2]e^{(\frac{-4\pi i }{N})}+...+f[N-1]e^{(\frac{-2\pi i (N-1)}{N})})\) \(\hat f[k = 2] = \frac{1}{N}(f[0]+f[1]e^{(\frac{-2*2\pi i }{N})}+f[2]e^{(\frac{-2*4\pi i }{N})}+...+f[N-1]e^{(\frac{-2\pi i 2* (N-1)}{N})})\)<br/> \(\hat f[k = m] = \frac{1}{N}(f[0]+f[1]e^{(\frac{-m*2\pi i }{N})}+f[2]e^{(\frac{-m*4\pi i }{N})}+...+f[N-1]e^{(\frac{-2\pi i m* (N-1)}{N})})\)</p> <p>If we define the <em>Fundamental Frequency</em>:</p> \[W_N = e^{-\frac{2\pi i }{N}}\] <p>Maybe you have noticed that $W_N$ is the last solution to the polinomial equation:</p> \[x^N = 1\] <p>Anyway, the DFT now becomes:</p> \[\hat f[k] = \frac{1}{N}\sum_{n=0}^{N-1}f[n]W_N^{kn}\] <p>In a matrix form:</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/DFT-480.webp 480w,/assets/img/2024-05-02-fft/DFT-800.webp 800w,/assets/img/2024-05-02-fft/DFT-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/DFT.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>If we calculate DFT in this way, the time complexity is $O(N^2)$.</p> <h2 id="fft-with-an-8-point-example">FFT with an 8-point example</h2> <p>One may notice that there are so many $W_N$ in the matrix, we calculate them again and again, and it there any way that we can make life easier and reuse the data we have calculated before. Recursively, we can divide the equation into <em>odd</em> and <em>even</em> components and they have the same factor and we can re-divide the equation into sub-<em>odd</em> and sub-<em>even</em> components and so on and so forth. This could result in a beautiful algorithm that can be explained with a butterfly diagram. Do not panic if you cannot understand what I am saying, I will explain this with an 8-point example.</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p1-480.webp 480w,/assets/img/2024-05-02-fft/8p1-800.webp 800w,/assets/img/2024-05-02-fft/8p1-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>I delibrately write the equation in a form of even and odd terms.</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p2-480.webp 480w,/assets/img/2024-05-02-fft/8p2-800.webp 800w,/assets/img/2024-05-02-fft/8p2-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Now the odd and even term has a same factor.</p> <p>The $e^{-\frac{2\pi i k}{8}}$ is called <em>twiddle factor</em>.</p> <p>\(W_t = W_M^k\)<br/> You will see that the $M$ will be divided from N by a factor of 2 every time we separate the odd and even terms. <strong>Please note that there is a important $k$ thing in the exponential term</strong>, which actually causes more trouble to understand the FFT. I did not notice that at first and thought I understood FFT. However, when going over the whole materials, I noticed that k thing and realised that I just did not understand FFT.</p> <p>We can do the same thing 2 more times:</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p3-480.webp 480w,/assets/img/2024-05-02-fft/8p3-800.webp 800w,/assets/img/2024-05-02-fft/8p3-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Notice in the exponential term, we can divide both numerator and denominator by a 2.</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p4-480.webp 480w,/assets/img/2024-05-02-fft/8p4-800.webp 800w,/assets/img/2024-05-02-fft/8p4-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Get new twiddle factor out:</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p5-480.webp 480w,/assets/img/2024-05-02-fft/8p5-800.webp 800w,/assets/img/2024-05-02-fft/8p5-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Divide both numerator and denominator by a 2.</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p6-480.webp 480w,/assets/img/2024-05-02-fft/8p6-800.webp 800w,/assets/img/2024-05-02-fft/8p6-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p6.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Ok, now the last time:</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p7-480.webp 480w,/assets/img/2024-05-02-fft/8p7-800.webp 800w,/assets/img/2024-05-02-fft/8p7-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p7.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Not the $log_2N^th$ twiddle factor is $e^{-\frac{2\pi i 0* k}{1}} = 1$. So now the thing becomes to:</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p8-480.webp 480w,/assets/img/2024-05-02-fft/8p8-800.webp 800w,/assets/img/2024-05-02-fft/8p8-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p8.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Rearrange them:</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p9-480.webp 480w,/assets/img/2024-05-02-fft/8p9-800.webp 800w,/assets/img/2024-05-02-fft/8p9-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p9.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>For those who have seen the butterfly diagram probably will shout out: <em>Oh that is the butterfly thing!</em> (That is what I did at the first time learning this topic). Do not forget the $k$ in the exponential! What does it mean? It means that for every $k$, the computer needs to go through every calculation one time. Beacuse the $k$ value varies and we need to compute everything again when meet a new $k$. Besides what we did just now is just doing rearrangement and this doesn’t relieve any of the computational complexity. So the time complexity till now is still $O(N^2)$. <strong>What the butterfly diagram tells us is that we can resuse the results at each stage(the separation of odd and even terms)</strong>. But what we have acchieved cannot promise that.</p> <p>Now we comes to the most important part(I think because I spend days of time to figure out what’s gonna be next)</p> <h2 id="how-to-read-a-butterfly-diagram">How to read a butterfly diagram</h2> <p>Next we will work through the whole thing with butterfly diagram as a reference. So let’s read it first.</p> <ul> <li>Each line(or arrow) is a multiplication by a factor(a constant)</li> <li>Each dot(end points of 2 lines) is an addition</li> <li>Each branch(start points of 2 branches) means the value after multiplication can go either way.</li> </ul> <p>Actually this graph clearly demostrates that the time complexity is $NlogN$. With the stage number of $log(N)$ and $N ‘+’ and N ‘*’$ at each stage.</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/butterfly-480.webp 480w,/assets/img/2024-05-02-fft/butterfly-800.webp 800w,/assets/img/2024-05-02-fft/butterfly-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/butterfly.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> A butterfly diagram.<d-cite key="C25_2"></d-cite></div> <h2 id="connections-with-butterfly-diagramthe-elimination-of-k-in-twiddle-factors">Connections with butterfly diagram–the elimination of k in twiddle factors</h2> <p>Let’s re-look at the following equation:<br/> I delibrately write the equation in a form of even and odd terms.</p> <div class="row mt-5"> <div class="col-sm mt-5 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/8p9-480.webp 480w,/assets/img/2024-05-02-fft/8p9-800.webp 800w,/assets/img/2024-05-02-fft/8p9-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/8p9.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>For the $3^{rd}$ stage(the second left column), the twiddling factor is $W_{t3} = W_2 = e^{-\frac{2\pi i k}{2}}$</p> <p>\(W_{t3} = 1, k = even number\) \(W_{t3} = -1, k = odd number\)</p> <p>So no matter the $k$ in the third stage there can only be 2 options for a 2 point DFT. We can reuse the data in the first stage!</p> <p>Now let’s construct the butterfly diagram:</p> <p>If $k$ is even, we let the 0-4, 2-6, 1-5, 3-7 pair to combine and calculate a value and put it in the upper place, just as the red lines.</p> <p>Vice versa, if $k$ is odd, just to the computation with a different twiddling factor and put it in the lower place, just as the blue lines.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/stage3even-480.webp 480w,/assets/img/2024-05-02-fft/stage3even-800.webp 800w,/assets/img/2024-05-02-fft/stage3even-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/stage3even.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-05-02-fft/stage3odd-480.webp 480w,/assets/img/2024-05-02-fft/stage3odd-800.webp 800w,/assets/img/2024-05-02-fft/stage3odd-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-05-02-fft/stage3odd.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> The contruction of butterfly diagram </div> <p>OK, now that’s where we save the computation time. Originally, on the $3rd$ stage we need calculate $N * N/2 (‘<em>’ and ‘+’)$. Now we only need to calculate(N ‘</em>’ and ‘+’).</p> <p>And actually the same thing can be applied to the $2^{nd}$ stage and $1^{st}$ stage.</p> <p>We finished! You can derive the $2^{nd}$ stage and $1^{st}$ stage and construct the butterfly diagram by your self!</p> <h2 id="broken-matrixs">Broken matrixs</h2> <p>DFT matrix<br/> [ \begin{bmatrix} \hat f_0 <br/> \hat f_1 <br/> \vdots <br/> \hat f_{N-1} <br/> \end{bmatrix} = \frac{1}{N} \begin{bmatrix} 1 &amp; 1 &amp; 1 &amp; \dots &amp; 1<br/> 1 &amp; W_N &amp; W_N^2 &amp; \dots &amp; W_N^{N-1} <br/> \vdots &amp; &amp; &amp; &amp; \vdots <br/> 1 &amp; W_{N-1} &amp; W_N^{2(N-1)} &amp; \dots &amp; W_N^{(N-1)^2} <br/> \end{bmatrix} \begin{bmatrix} f_0 <br/> f_1 <br/> \vdots <br/> f_{N-1} <br/> \end{bmatrix} ]</p> <p>Code for 8-point equation 1-8</p> <ul> <li>1</li> </ul> <p>[ \hat f[k] = \frac{1}{8}\sum_{n=0}^{7} e^{-\frac{2\pi ikn}{8}} = \begin{matrix} f[0]e^{-\frac{2\pi i 0* k}{8}} + f[2]e^{-\frac{2\pi i 2* k}{8}} + f[4]e^{-\frac{2\pi i 4* k}{8}} + f[6]e^{-\frac{2\pi i 6* k}{8}} <br/> +f[1]e^{-\frac{2\pi i 1* k}{8}} +f[3]e^{-\frac{2\pi i 3* k}{8}} + f[5]e^{-\frac{2\pi i 5* k}{8}} + f[7]e^{-\frac{2\pi i 7* k}{8}} <br/> \end{matrix} ]</p> <ul> <li>2</li> </ul> <p>[ \hat f[k] = \frac{1}{8}\sum_{n=0}^{7} e^{-\frac{2\pi ikn}{8}} = \begin{matrix} f[0]e^{-\frac{2\pi i 0* k}{8}} + f[2]e^{-\frac{2\pi i 2* k}{8}} + f[4]e^{-\frac{2\pi i 4* k}{8}} + f[6]e^{-\frac{2\pi i 6* k}{8}} <br/> +e^{-\frac{2\pi i k}{8}}(f[1]e^{-\frac{2\pi i 0* k}{8}} +f[3]e^{-\frac{2\pi i 2* k}{8}} + f[5]e^{-\frac{2\pi i 4* k}{8}} + f[7]e^{-\frac{2\pi i 6* k}{8}}) <br/> \end{matrix} ]</p> <ul> <li>3</li> </ul> <p>[ \hat f[k] = \frac{1}{8}\sum_{n=0}^{7} e^{-\frac{2\pi ikn}{8}} = \begin{matrix} f[0]e^{-\frac{2\pi i 0* k}{8}} + f[4]e^{-\frac{2\pi i 4* k}{8}} <br/> + f[2]e^{-\frac{2\pi i 2* k}{8}} + f[6]e^{-\frac{2\pi i 6* k}{8}} <br/> +e^{-\frac{2\pi i k}{8}}(f[1]e^{-\frac{2\pi i 0* k}{8}} + f[5]e^{-\frac{2\pi i 4* k}{8}}) <br/> +e^{-\frac{2\pi i k}{8}}(f[3]e^{-\frac{2\pi i 2* k}{8}} + f[7]e^{-\frac{2\pi i 6* k}{8}}) <br/> \end{matrix} ]</p> <ul> <li>4</li> </ul> <p>[ \hat f[k] = \begin{matrix} f[0]e^{-\frac{2\pi i 0* k}{4}} + f[4]e^{-\frac{2\pi i 2* k}{4}} <br/> + f[2]e^{-\frac{2\pi i 1* k}{4}} + f[6]e^{-\frac{2\pi i 3* k}{4}} <br/> +e^{-\frac{2\pi i k}{8}}(f[1]e^{-\frac{2\pi i 0* k}{4}} + f[5]e^{-\frac{2\pi i 2* k}{4}}) <br/> +e^{-\frac{2\pi i k}{8}}(f[3]e^{-\frac{2\pi i 1* k}{4}} + f[7]e^{-\frac{2\pi i 3* k}{8}}) <br/> \end{matrix} ]</p> <ul> <li>5</li> </ul> <p>[ \hat f[k] = \begin{matrix} f[0]e^{-\frac{2\pi i 0* k}{4}} + f[4]e^{-\frac{2\pi i 2* k}{4}} <br/> + e^{-\frac{2\pi i k}{4}}[f[2]e^{-\frac{2\pi i 0* k}{4}} + f[6]e^{-\frac{2\pi i 2* k}{4}}] <br/> +e^{-\frac{2\pi i k}{8}}{f[1]e^{-\frac{2\pi i 0* k}{4}} + f[5]e^{-\frac{2\pi i 2* k}{4}}} <br/> +e^{-\frac{2\pi i k}{8}}{e^{-\frac{2\pi i k}{4}}[f[3]e^{-\frac{2\pi i 0* k}{4}} + f[7]e^{-\frac{2\pi i 2* k}{4}}]} <br/> \end{matrix} ]</p> <ul> <li>6</li> </ul> <p>[ \hat f[k] = \begin{matrix} f[0]e^{-\frac{2\pi i 0* k}{2}} + f[4]e^{-\frac{2\pi i 1* k}{2}} <br/> + e^{-\frac{2\pi i k}{4}}[f[2]e^{-\frac{2\pi i 0* k}{2}} + f[6]e^{-\frac{2\pi i 1* k}{2}}] <br/> +e^{-\frac{2\pi i k}{8}}{f[1]e^{-\frac{2\pi i 0* k}{2}} + f[5]e^{-\frac{2\pi i 1* k}{2}}} <br/> +e^{-\frac{2\pi i k}{8}}{e^{-\frac{2\pi i k}{4}}[f[3]e^{-\frac{2\pi i 0* k}{2}} + f[7]e^{-\frac{2\pi i 1* k}{2}}]} <br/> \end{matrix} ]</p> <ul> <li>7</li> </ul> <p>[ \hat f[k] = \begin{matrix} f[0]e^{-\frac{2\pi i 0* k}{1}} <br/> +e^{-\frac{2\pi i 1* k}{2}} * f[4]e^{-\frac{2\pi i 0* k}{1}} <br/> + e^{-\frac{2\pi i k}{4}}[f[2]e^{-\frac{2\pi i 0* k}{1}}] <br/> + e^{-\frac{2\pi i k}{4}}[ e^{-\frac{2\pi i 1* k}{2}} * f[6]e^{-\frac{2\pi i 0* k}{1}}] <br/> +e^{-\frac{2\pi i k}{8}}{f[1]e^{-\frac{2\pi i 0* k}{1}}} <br/> +e^{-\frac{2\pi i k}{8}}{e^{-\frac{2\pi i 1* k}{2}} * f[5]e^{-\frac{2\pi i 0* k}{1}}} <br/> +e^{-\frac{2\pi i k}{8}}{e^{-\frac{2\pi i k}{4}}[f[3]e^{-\frac{2\pi i 0* k}{1}}]} <br/> +e^{-\frac{2\pi i k}{8}}{e^{-\frac{2\pi i k}{4}}[e^{-\frac{2\pi i 1* k}{2}} f[7]e^{-\frac{2\pi i 0* k}{1}}]} <br/> \end{matrix} ]</p> <ul> <li>8</li> </ul> <p>[ \hat f[k] = \begin{matrix} f[0] <br/> +e^{-\frac{2\pi i 1* k}{2}} * f[4] <br/> + e^{-\frac{2\pi i k}{4}}[f[2]] <br/> + e^{-\frac{2\pi i k}{4}}[ e^{-\frac{2\pi i 1* k}{2}} * f[6]] <br/> +e^{-\frac{2\pi i k}{8}}{f[1]} <br/> +e^{-\frac{2\pi i k}{8}}{e^{-\frac{2\pi i 1* k}{2}} * f[5]} <br/> +e^{-\frac{2\pi i k}{8}}{e^{-\frac{2\pi i k}{4}}[f[3]]} <br/> +e^{-\frac{2\pi i k}{8}}{e^{-\frac{2\pi i k}{4}}[e^{-\frac{2\pi i 1* k}{2}} f[7]]} <br/> \end{matrix} ]</p> <ul> <li>9</li> </ul> <p>[ \hat f[k] = \begin{matrix} &amp; f[0] &amp; &amp; &amp; <br/> + &amp; f[4] &amp; <em>e^{-\frac{2\pi i k}{2}}&amp; &amp; <br/> + &amp; f[2]&amp; &amp; * e^{-\frac{2\pi i k}{4}} &amp; <br/> + &amp; f[6] &amp;</em>e^{-\frac{2\pi i k}{2}}&amp; <em>e^{-\frac{2\pi i k}{4}} &amp; <br/> + &amp; f[1] &amp; &amp; &amp; *e^{-\frac{2\pi i k}{8}}<br/> + &amp; f[5] &amp; *e^{-\frac{2\pi i k}{2}}&amp; &amp; *e^{-\frac{2\pi i k}{8}}<br/> + &amp; f[3]&amp; &amp; * e^{-\frac{2\pi i k}{4}} &amp; *e^{-\frac{2\pi i k}{8}}<br/> + &amp; f[7] &amp;</em>e^{-\frac{2\pi i k}{2}}&amp; *e^{-\frac{2\pi i k}{4}} &amp; *e^{-\frac{2\pi i k}{8}}<br/> \end{matrix} ]</p>]]></content><author><name></name></author><category term="algorithms"/><category term="advanced-transforms"/><category term="algorithms"/><category term="longposts"/><summary type="html"><![CDATA[When learning this topic, I encountered a problem regarding the Twiddle Factor and the butter fly diagram. Here is my explanation with a derivation of 8 point example.]]></summary></entry><entry><title type="html">Can high voltage battery shocks a man?How? 一块高压蓄电池能否以及如何让人中电?</title><link href="https://toflamus.github.io/blog/2024/battery-and-GND/" rel="alternate" type="text/html" title="Can high voltage battery shocks a man?How? 一块高压蓄电池能否以及如何让人中电?"/><published>2024-04-28T21:25:00+00:00</published><updated>2024-04-28T21:25:00+00:00</updated><id>https://toflamus.github.io/blog/2024/battery-and-GND</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/battery-and-GND/"><![CDATA[<p>今天在看L.Plett的BMS书，Vol2 电池安全防护这一节（1.7）。突然让我重新回忆起一个困扰我许久的问题。</p> <blockquote> <p>假设一个人手握一个12V的电池的正负极的任意一级光脚站在地上。它感受到的电压是多少？握在正极和负极的感受到的电压一样吗？btw 这里我主要是想讨论中电问题，也就是说一个人是否会因为触摸高电压电池而中电。</p> </blockquote> <p>我之前所想的是：</p> <ul> <li>一块高压蓄电池的电压的主要部分是由物理化学规律决定的，那么这个电压就是一个相对电压，我无法得到某个电极的绝对电压。因此也无法衡量一个电极和大地的电势差，也无法根据36V安全定律来判断是否会安全。</li> <li>并且因为人和电池没有形成回路，那么如何放电。</li> </ul> <p>然而在朋友圈进行询问之后不久便得到了一个答案，醍醐灌顶：</p> <blockquote> <p>你把它想象成电容就好理解了,12V只是两块板之间的电压差，而你感受的电压跟你手中那块极板到地面的距离，还有各种其他因素决定，不是固定的。<br/> ——来自Magdalen的好兄弟</p> </blockquote> <p>从[C = \frac{\epsilon S}{d}] 上来讲，因为距离很远，面积很小，所以电容基本上是0，[U = Q/C] 所以电压可能会很大，但是因为电荷是非常少的，所以电压也不会大到离谱的地步。</p> <p>电容解释非常中肯，在真实的电池体系中也会出现Double layer capacitance。在电极材料表面就会充电。电池的充放电的回路要求是建立在基尔霍夫定律上的。就是说电荷守恒的条件，但是这个条件在带电体的形况下不满足。</p> <p>这不禁让我回想起初中时的测量物体是否带电的实验。摩擦毛皮和玻璃棒让后放到测电器的金属球上面，测电器的金属箔片会打开一个小张角，证明玻璃棒带电。</p>]]></content><author><name></name></author><category term="battery-study"/><category term="batteries"/><category term="insights"/><category term="shortposts"/><category term="chinese"/><summary type="html"><![CDATA[A interesting problem regarding a man holding battery electrode and standing on the ground.一个关于高压蓄电池如何让人中电的有趣问题。]]></summary></entry><entry><title type="html">Hysteresis voltage modeling</title><link href="https://toflamus.github.io/blog/2024/Hysteresis-voltage/" rel="alternate" type="text/html" title="Hysteresis voltage modeling"/><published>2024-04-27T14:25:00+00:00</published><updated>2024-04-27T14:25:00+00:00</updated><id>https://toflamus.github.io/blog/2024/Hysteresis-voltage</id><content type="html" xml:base="https://toflamus.github.io/blog/2024/Hysteresis-voltage/"><![CDATA[<h2 id="hysteresis-voltage">Hysteresis voltage</h2> <p>Definition: OCV-SOC curves for charging and discharging Li-ion batteries do not overlap. The difference between the curves is defined as <em>Hysteresis voltage</em>.</p> <p>The modeling can be physics-based or phenomenon-based.</p> <p>I find the modeling of hysteresis is a deep field because the hysteresis phenomenon can happen in various disciplines. There is even a book about hysteresis modeling<d-cite key="hysteresismodelingmath"></d-cite>. There are plenty of different models to model a hysteresis, such as Prandtl-Ishlinskii hysteresis model<d-cite key="4739202"></d-cite>(This is a topic in control engineering). However, they are not covered in this blog post. I just put them here for further reference. The main framework is still from L. Plett’s book.<d-cite key="BMS_vol1"></d-cite></p> <h2 id="main-loop-and-minor-loop">Main loop and minor loop</h2> <p>This part is mainly from the Guillaume Larrat’s thesis. <d-cite key="Lihysteresismodeling"></d-cite></p> <p>The charging and discharging OCV curves that were displayed in the figure below allows to create a voltage hysteresis loop for a SOC varying from 0% to 100% which includes the whole range of possible values for the SOC.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/OCV_curve-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/OCV_curve-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/OCV_curve-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/OCV_curve.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>It is composed of the two <strong>major</strong> OCV curves: a charge from 0% to 100% SOC and a full discharge from 100% to 0%. The corresponding voltage hysteresis loop is then called a major loop. However, if the cell is partially charged or discharged from a state different than 0% or 100%, the OCV will not follow the two curves displayed earlier. If a cell is at a 60% SOC and is then discharged to 40% and then charged back to 60%, this will create a minor loop as shown in Figure below:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/major_minor_loop-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/major_minor_loop-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/major_minor_loop-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/major_minor_loop.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Assupmtion: The loop of a real-time charge/discharge process only locates insides the major loop. Apparently, the changing rate in a minor loop is different from the major loop.</p> <h2 id="hysteresis-modeling">Hysteresis modeling</h2> <p>Let’s just build a simple model:<br/> Assumptions:</p> <ul> <li>Linear: The changing rate of hysteresis voltage only depends the difference between maxium OCV and current OCV.</li> <li>Past path invariant: The hyseresis does not depend on how to get to the state but just and past state themselves. Actually, this is not true.</li> </ul> <p>\(h(z(t)) = OCV_{charge}(z(t))-OCV_{discharge}(z(t))\) \(\frac{dh(z,t)}{dz} = \gamma sgn(\dot z)(M(z,\dot z)- h(z,t))\)</p> <p>$\gamma$ is just a coefficient for linear approximation.<br/> $M(z,\dot z)$: A function that gives the maximum polarization due to the hysteresis as a function of SOC and rate of charge.<br/> $M(z,\dot z)- h(z,t)$: Indicates that the rate of change of the hysteresis voltage is proportional to the distance of the current hysteresis value from the main hysteresis loop. In other words, the driving force decides the rate of change.<br/> $z(t)$ defines the changing direction of the hysteresis. For charging process, $\dot z &gt; 0$, which means hysteresis tends to be larger, this means the $$OCV_{charge}(z(t))$ tends to be closer to the maximum OCV.</p> <p>Because our previous equivalent circuit model depends on the time, we use the chain rule to make the differencial equation a function of time.</p> \[\frac{dh(z,t)}{dz} \frac{dz}{dt} = \gamma sgn(\dot z)(M(z,\dot z)- h(z,t)) \frac{dz}{dt}\] <p>\(\frac{dz}{dt} = -\eta(t)i(t)/Q\) $\dot z sgn(\dot z) = |z|$</p> \[\frac{dh(z,t)}{dz} \frac{dz}{dt} = \gamma (M(z,\dot z)- h(z,t)) *|\frac{\eta(t)i(t)}{Q}|\] <p>To make life easier <strong>assume $I(t)$ &amp; $M(z,\dot z)$ are constant during sampling period</strong>. So if one want to get the fully profile, multiple linear approximation can be made to tackle this problem.</p> <p>Solve the ODE and make it discrete, and do some rearrangements:</p> \[h[s+1] = exp(-|\frac{\eta[s]I\Delta t\gamma}{Q}|)h[s] + M(z,\dot z)(1-exp(-|\frac{\eta[s]I\Delta t\gamma}{Q}|))\] <p>Note: $M(z,\dot z) $ varies with current orientation, the simplest way to make it a const is by $M(z,\dot z) = -M sgn(i(t))$</p> <p>Now the equation becomes:</p> \[h[s+1] = exp(-|\frac{\eta[s]I\Delta t\gamma}{Q}|)h[s] - Msgn(i(t))(1-exp(-|\frac{\eta[s]I\Delta t\gamma}{Q}|))\] <table> <tbody> <tr> <td>$A_H[s] = exp(-</td> <td>\frac{\eta[s]I\Delta t\gamma}{Q}</td> <td>)$</td> </tr> </tbody> </table> \[h[s+1] = A_H h[s] - Msgn(i(t))(1-A_H)\] <p>We can normalize the result by devide the equation by $M$.</p> <p>\(\hat h[s+1] = A_H \hat h[s] - sgn(i(t))(1-A_H)\) \(Hysteresis voltage = M\hat h[s]\)</p> <p>Now this model can be viewed as a linear model <em>dynamic hysteresis</em> that goes through the origin point. However, in reality it is a good idea to model a const in case the curve do not fit the origin. The const is called <em>instaneous hysteresis</em>. It also contains the information when the current direction changes.</p> <p>[ \hat h_{ins}[s] = \begin{matrix} sgn(i[s]), |i[s]|&gt;0<br/> \hat h_{int}[s-1], otherwise.<br/> \end{matrix} ]</p> <p>The <em>instaneous hysteresis</em> is:</p> \[Instaneous hysteresis = M_0 \hat h_{int}[s]\] <h2 id="enhanced-self-correcting-esc-model">Enhanced self-correcting (ESC) model</h2> <p><em>Enhanced</em> means the model also includes hysteresis effects.<br/> <em>Self-correcting</em> means the model converges to the $OCV+hysteresis$ when $i = 0$</p> <p>From the discussion on equivalant circuit models, now with new information with hysteresis effects. The OCV with half cell equivalent circuit can be viewed as follows:</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/circuit1-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/circuit1-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/circuit1-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/circuit1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> half-cell with OCV and hysteresis </div> <p>When the time scale difference bewteen Warburg impedance and other circuit elements are so large, that the Warburg impedance get out on to the main branch.</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/circuit2-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/circuit2-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/circuit2-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/circuit2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> approximation of half-cell with OCV and hysteresis. </div> <p>As we have discussed in another blog the linear part of Warburg impedance can be approximated by a series of parallel resistor-and-capacitor pairs.</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/circuit3-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/circuit3-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/circuit3-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/circuit3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>Let’s denote the charge transfer resistance and double layer capacity as $R_{0}$ and $C_{0}$</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/circuit4-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/circuit4-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/circuit4-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/circuit4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <h3 id="single-resistor-and-capacitor-pair">Single resistor-and-capacitor pair</h3> <p>Let’s use the current to analyze a resistor-and-capacitor pair.</p> <p>For a single pair, use the voltage change of a single resistor-and-capacitor pair as a birdge:</p> <p>\(u_k = \frac{Q_k}{C_k} = \frac{1}{C_k}\int_0^t I-i_k dt\) \(u_k = R_k i_k\)</p> <p>where $i_k$ is the current goes through $R_k$ and I is main branch current.</p> <p>After take a derivative and rearrangement:</p> \[i_k(t) + \frac{i(t)}{C_kR_k} = \frac{I(t)}{C_kR_k}\] <p>Solve the ODE using Cauchy’s method.</p> \[i_k(t) = Ae^{-\frac{t}{C_kR_k}} + i_c(t)\] <p>When in reality, the I(t) can be AC current such as in the case of (EIS). So it can be extended to a fourier series. This means the solution of the ODE is also a fourier series, denoted $i_c(t) = I’(t)$.</p> <p>Now let’s think about the discret form.</p> <p>\(i_k[s] = Ae^{-\frac{s\Delta t}{C_kR_k}} + i_c[s]\) \(i_k[s+1] = Ae^{-\frac{(s+1)\Delta t}{C_kR_k}} + i_c[s+1]\)</p> <p>Then:</p> <p>\(i_k[s+1] = F_k * i_k[s] + i_c[s+1] - F_k i_c[s]\) \(F_k = e^{-\frac{\Delta t}{C_kR_k}}\)</p> <p>To make life easier <strong>assume I(t) is a constant during sample period</strong>. So if one want to get the fully profile, multiple linear approximation can be made to tackle this problem.</p> \[i_c[s] = i_c[s+1] = I\] <p>The original solution becomes:<br/> \(i_k[s+1] = F_k * i_k[s] + (1- F_k)I\)</p> <p>Convert this equation to a matrix form:</p> <p>\(\vec i_r[s+1] = \mathbb A_{RC} * \vec i_r[s] + b_{RC} I\) \(\mathbb A_{RC} = diag(F_k)\) \([\vec b_{RC}]_i = 1-F_i\)</p> <h3 id="esc-model-and-its-state-equation">ESC model and its <em>state equation</em></h3> <p>Combine everything above together, we get the <em>state equation</em> of ESC model</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/SCM-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/SCM-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/SCM-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/SCM.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>The voltage of the model is estimated by:</p> \[v[s] = OCV(z[s],T[s]) + M\hat h[s] + M_0 \hat h_{int}[s] - \sum_j^n R_ji_{R_j}[s] -R_u i[s]\] <h2 id="afterwords">Afterwords</h2> <h3 id="soc-method-to-analysis-the-circuit">SOC method to analysis the circuit</h3> <p>When considering the voltage of each resistor-and-capacitor pair,the ODE for a single resistor-and-capacitor pair is:</p> \[\dot u_i = -\frac{1}{R_i C_i} u_i + \frac{1}{C_i} I\] <p>The ODEs for resistor-and-capacitor pairs can be expressed as:</p> <div class="row mt-3"> <div class="col-sm mt-4 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-27-Hysteresis-voltage/SOC-480.webp 480w,/assets/img/2024-04-27-Hysteresis-voltage/SOC-800.webp 800w,/assets/img/2024-04-27-Hysteresis-voltage/SOC-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/2024-04-27-Hysteresis-voltage/SOC.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <p>This is the method with voltage to describe the SOC but however I need to use current instead of voltage to analyze the circuit here.</p> <h3 id="somenotes">Somenotes</h3> <p>My matrix was inappropriately deployed for some reasons. I just used a <code class="language-plaintext highlighter-rouge">.png</code> instead. Here is the original matrix.</p> <p>For SCM:</p> <p>[ \begin{bmatrix} z[s+1] \<br/> \vec i_r[s+1] \<br/> h[s+1]\<br/> \end{bmatrix} = \begin{bmatrix} 1 &amp; 0 &amp; 0\<br/> 0 &amp; \mathbb A_{RC} &amp; 0 \<br/> 0 &amp; 0 &amp; A_H\<br/> \end{bmatrix} \begin{bmatrix} z[s]\<br/> \vec i_r[s]\<br/> h[s]\<br/> \end{bmatrix} + \begin{bmatrix} -\frac{\eta [s] \Delta t}{Q} &amp; 0\<br/> \vec b_{RC} &amp; 0 \<br/> 0 &amp; A_H-1 \<br/> \end{bmatrix} \begin{bmatrix} I \<br/> sgn(I)\<br/> \end{bmatrix} ]</p> <p>For SOC method: \begin{equations} \begin{bmatrix} \dot u_0<br/> \dot u_1<br/> \vdots<br/> \dot u_n<br/> \end{bmatrix} = \begin{bmatrix} -\frac{1}{C_0R_0} &amp; 0 &amp; \cdots &amp; 0 <br/> 0 &amp; -\frac{1}{C_1R_1} &amp; \cdots &amp; 0 <br/> \vdots &amp; 0 &amp; \cdots &amp; 0 <br/> 0 &amp; \cdots &amp; 0 &amp; -\frac{1}{C_nR_n}<br/> \end{bmatrix} \begin{bmatrix} u_0<br/> u_1<br/> \vdots<br/> u_n<br/> \end{bmatrix} + \begin{bmatrix} \frac{1}{C_0}<br/> \frac{1}{C_1}<br/> \vdots<br/> \frac{1}{C_n}<br/> \end{bmatrix} I \end{equations} I did not heard about this topic too much before when I concentrated at ElectroChemistry. The hysteresis effect is important for Battery Management Systems.</p>]]></content><author><name></name></author><category term="battery-study"/><category term="batteries"/><category term="longposts"/><category term="lithium-ion"/><summary type="html"><![CDATA[Simple introduce hysteresis voltage and its phenomenological modeling]]></summary></entry></feed>