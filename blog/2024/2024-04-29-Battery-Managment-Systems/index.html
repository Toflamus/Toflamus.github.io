<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h2 id="an-introduction-to-bms">An introduction to BMS</h2> <p>The scale of the book is mainly on how to manage battery system, involves the hardware and software parts. The software part is stressed by different algorithms to model the battery packs.</p> <blockquote> <p>Definition of <em>Battery management(monitoring) systems(BMS)</em>: A permanently installed system(embeded) for measuring, storing and reporting battery parameters.<br> –IEEE Standard 1491.</p> </blockquote> <p>Purposes:</p> <ol> <li>To protect the safety of operator and system components.</li> <li>To prolong the life of the batteries.</li> <li>To keep the battery functioning.</li> </ol> <p>Marginal effect: When do we need BMS？</p> <p>Cost of failure(Expectation) and related cost higher than then cost of BMS.</p> <p>Important in such cases:</p> <ul> <li> <em>Hybrid-electric vehicles(HEVs)</em>: Never charge its batteries by a blug. The BMS combines the gasoline engine and make full use of the energy.</li> <li> <em>Plug-in HEVs(PHEVs)</em>: It can opertate in electric only mode and prosess a larger battery pack. <ul> <li>Charge-depletion mode: Just use electricity to operate.</li> <li>Charge-sustaining mode: When the battery is nearly empty, it starts to work like HEVs.</li> </ul> </li> <li> <em>Extend-range electric vehicles(REVs)</em>: Small gasoline engine and large battery pack. Can operate just like EVs. When the battery runs out of capacity, the gasoline engine provides <em>extended range</em>.</li> <li> <p><em>EVs</em>: Battery-electric vehicles.</p> </li> <li>Grid storage powers, telecoms off-grid power.</li> </ul> <h2 id="battery-pack-topology">Battery-pack topology</h2> <p>Topology is a branch of mathematics that deals with the properties of space that are preserved under continuous deformations, such as stretching, crumpling, and bending, but not tearing or gluing.</p> <p>However, here the word topology refers to how to construct a battery pack. Taking the EVs as an example, a EV generally needs high voltage and large current density.</p> <p>High voltage can be achieved by placing the batteries in series, a <em>series-cell-module(SCM)</em>. While large current density can be achieved by placing them in parallel, a <em>parallel-cell-module(PCM)</em>. However, they all have there defects like large inner resistances which may result in low current and low voltage, respectively.</p> <p>Consequently, there is a <strong>trade-off between series or parallel packing</strong>.</p> <p>However, in engineering practice, we usually build a complex system in modules. We first optimize the topology in a single module and then optimize the topology in modules combinations, so on and so forth. This methodology reduces NRE costs.</p> <p>For example, a classic <em>3P6S</em> module has 18 cells, 3 in parallel and 6 in series. The power and energy are then boteh approximately 18 times that of a single cell.</p> <h2 id="bms-design-requirements">BMS design requirements</h2> <ul> <li>Sensing and high-voltage control: $u,i,T$ monitoring.</li> <li>Protection: against overcharge, overdischarge, overcurrent, short circuits, extreme temperatures.</li> <li>Interface: report the status</li> <li>Performance management: SOC management…</li> <li>Diagnostics: (State of health)SOH, (State of life)SOL …</li> </ul> <h3 id="requirement1-battery-pack-sensing">Requirement1: Battery-pack sensing</h3> <h4 id="voltage">Voltage</h4> <p>Intergrated circuit are ofter used, such as LTC6803<br> Basic structure: <em>Master-slave system</em></p> <p>When many cells are connected in series <em>high voltage isolation</em> is required but challenging.</p> <h4 id="temperature">Temperature</h4> <p>Battery-pack sensinig: <strong>Temperature</strong>: A model is needed to monitor the temperature inside the battery from external temperature.</p> <p><em>Thermocouple</em>: A thermocouple uses 2 different metals to contact and a tiny voltage generate from from the contact. The voltage can be amplified and measured. However, the measurement requires the a relative sample metal at a known temperature. In other words, it needs a reference state. This method is good for lab but not for production BMS designs.</p> <p><em>Themistor</em>: Resistor-temperature relationship.</p> <p><em>Resistance thermometers(resistance temperature detectorsRTD)</em>: Using resistance/temperature relationship of metals, generally pure materials(Cu, Ni, Pt), to detect temperature. Accurate, fragile. Mostly used in lab.</p> <p>A circuit is used to monitor the resistances of thermistor. Then you can look up to the table for the thermistor-temperature relationship.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/circuit-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/circuit-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/circuit-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/circuit.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h4 id="current">Current</h4> <p><em>Current-shunt</em>: Use a low-value($0.1m\Omega$), high-precision resistor. the $i = v_{shunt}/R_{shunt}$. The signal needs an amplifier to be detectable.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/currentshunt-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/currentshunt-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/currentshunt-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/currentshunt.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The figure is from L.Plett's book.&lt;d-cite, key='BMS_vol2'&gt;&lt;\d-cite&gt; </div> <ul> <li>Pros: <ul> <li>No zero offset<d-footnote>This may refers to the semiconductor diode which has a threshold voltage to allow current to past through it like short circuit. </d-footnote> compared with hall-effect sensors, regradless of temperature(if the resistor do not vary with temperature).</li> </ul> </li> <li>Cons: <ul> <li>It needs an isolated power supply to support amplifiers.</li> <li>Generate slight amount of hear.</li> </ul> </li> </ul> <p><em>Hall-effect sensors</em>: Detect the magnetic field associated with a current flowing.<br> A good <a href="https://www.allegromicro.com/en/insights-and-innovations/technical-documents/hall-effect-sensor-ic-publications/hall-effect-ic-applications-guide" rel="external nofollow noopener" target="_blank">web</a> about Hall-effect sensors.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/hall-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/hall-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/hall-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/hall.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The figure is from L.Plett's book.&lt;d-cite, key='BMS_vol2'&gt;&lt;\d-cite&gt; </div> <ul> <li>Pros: <ul> <li>No isolated power supply.</li> </ul> </li> <li>Cons: <ul> <li>Zero-offset that is hard to calibrate.</li> <li>The zero offset is time and temperature dependent.</li> </ul> </li> <li>Protection: against overcharge, overdischarge, overcurrent, short circuits, extreme temperatures.</li> <li>Interface: report the status</li> <li>Performance management: SOC management…</li> <li>Diagnostics: (State of health)SOH, (State of life)SOL …</li> </ul> <h4 id="high-voltage-contactor-control">High-voltage contactor control</h4> <p>The thing is that most of battery loads are often capacitive, before it can function, a charging process will be started first. If you just use a pure contactor at the starting point the contactor may get fused.</p> <p>So a pre-contrator with a resistor is needed. Just to control the charging process not to be too fast with extreme large current.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/precontactor-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/precontactor-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/precontactor-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/precontactor.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> (a)-(e) demonstrate the process to start charging a device. &lt;d-cite, key='BMS_vol2'&gt;&lt;\d-cite&gt; </div> <h4 id="isolation-sensing">Isolation sensing</h4> <p>Just take a the lead-acid battery in an car as an example. The voltage of the battery is 12V and it is directly installed on the chassis. Though the battery has a package and a totally invisable circuit away from people. However, no one can make sure when there is an accident, the chassis do not connect to one of the electrodes of the battery.</p> <p>In a large battery pack, the DC bus voltage can be in the range of <strong>300~800V</strong>. Consequently, there is a requirement to detect it is shunt or not with chassis. A safety current limit is <strong>0.2mV</strong>.</p> <p>A circuit is required to estimates the isolation resistance on each side of the pack.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/isolationdetect-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/isolationdetect-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/isolationdetect-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/isolationdetect.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Isolation detect circuit &lt;d-cite, key='C26_2'&gt;&lt;\d-cite&gt; </div> <h3 id="requirement4-energy-and-power-estimation">Requirement4: Energy and power estimation</h3> <p>There are only 3 parameters that we know the temperature current and voltage of battery $i$ in the $k^{th}$ time step,$v_k^{(i)}, i_k^{(i)}, T_k^{(i)}$</p> <p>However we need SOC($z_k^{i}$), SOV, remaining capacity$Q_k^{i}$ and inner reisistance$R_k^{i}$ to get energy and power abailable in the next period of time.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2024-04-29-Battery-Managment-Systems/EandPestimationwf-480.webp 480w,/assets/img/2024-04-29-Battery-Managment-Systems/EandPestimationwf-800.webp 800w,/assets/img/2024-04-29-Battery-Managment-Systems/EandPestimationwf-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/2024-04-29-Battery-Managment-Systems/EandPestimationwf.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Energy and power estimation workflow &lt;d-cite, key='BMS_vol2'&gt;&lt;\d-cite&gt; </div> <h4 id="soc-estimation">SOC estimation</h4> <p>I will do this part in the future</p> <h4 id="energy-estimation">Energy estimation</h4> <p>I will do this part in the future</p> <h4 id="power-estimation">Power estimation</h4> <p>I will do this part in the future</p> <h2 id="afternotes">Afternotes</h2> <p><em>Non-Recurring Engineering(NRE)</em>: Non-Recurring Engineering is the cost of creating a new product and is usually fully paid before any product gets manufactured. This is in contrast with production cost, which is an ongoing cost and is generally based on the quantities produced. For example, in the camera lens industry, the NRE would be the cost of developing the lens designs and tools which will make the lens smooth; the production cost would be the cost to manufacture each camera lens.</p> <p><em>Contactor</em> A contactor is an electrically controlled switch used for switching an electrical power circuit. A contactor is typically controlled by a circuit which has a much lower power level than the switched circuit, such as a 24-volt coil electromagnet controlling a 230-volt motor switch.</p> <p><em>Amplifier(amp)</em>:An amplifier, electronic amplifier or (informally) amp is an electronic device that can increase the magnitude of a signal (a time-varying voltage or current). It is a two-port electronic circuit that uses electric power from a power supply to increase the amplitude (magnitude of the voltage or current) of a signal applied to its input terminals, producing a proportionally greater amplitude signal at its output.<a href="https://en.wikipedia.org/wiki/Amplifier" rel="external nofollow noopener" target="_blank">from wikipedia:</a> This is a kind of <em>active devices</em>(provide outpurs containing more power than their inputs), which means they need extra power supply.</p> <p><em>Common mode rejection ratio (CMRR)</em> of amp: <a href="https://en.wikipedia.org/wiki/Common-mode_rejection_ratio" rel="external nofollow noopener" target="_blank">wikipedia</a></p> <p><em>Analog-to-digital converter (ADC)</em> The device to convert a <strong>continuous</strong> analog signal(sound wave or sth) to a <strong>discrete</strong> digital signal. It involves some issure with sampling frequency, above which the information loss and <em>aliasing</em> may rise. The sample rate is determined by <em>Nyquist-Shannon sampling theorem</em>.</p> <p><em>Bus voltage</em> is the total voltage between power and ground(GND). It is the sum of the load voltage and the shunt voltage.<br> <em>Load voltage</em> is the voltage going to the load. <em>Shunt voltage</em> is the voltage drop across the shunt resistor that is in series with the load.</p> <p><em>chassis</em>(ʃæ̱si) A <em>chassis</em> is the framework that a vehicle is built on.</p> <p>现在感觉真是越看不懂的越多，对于amp和hall element都有一个叫做zero offset的东西。 这个东西好像很深奥，然后对于不同的材料对于这个offset的modeling也不同。只能从主干入手了。旁支末节聊记于此，有心时再研究吧。</p> </body></html>